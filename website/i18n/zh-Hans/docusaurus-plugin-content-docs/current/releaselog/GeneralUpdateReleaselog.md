---
slug: releaselog
title: GeneralUpdate
authors: juster
tags: [log]
---

# ğŸ“’æ›´æ–°æ—¥å¿—

## ğŸ“2025-01-13 9.1.5

- ä¿®å¤LastVersionå–å€¼é”™è¯¯é—®é¢˜



## ğŸ“2025-01-13 9.1.4

- ä¿®å¤Environment.SetEnvironmentVariableå‡½æ•°å¸¦æ¥çš„æ‰§è¡Œç¼“æ…¢é—®é¢˜ã€‚
- åœ¨é»‘åå•ä¸­æ·»åŠ äº†ä»¥ä¸‹ClientCore å’Œ Coreå…±åŒå¼•ç”¨çš„æ–‡ä»¶ï¼ˆæ•´ä¸ªæ‰“åŒ…ã€å‡çº§æµç¨‹éƒ½ä¸ä¼šæ“ä½œè¿™äº›æ–‡ä»¶ï¼‰ï¼š

```c#
"Microsoft.Bcl.AsyncInterfaces.dll",
"System.Collections.Immutable.dll", 
"System.IO.Pipelines.dll", 
"System.Text.Encodings.Web.dll",
"System.Text.Json.dll"
```



## ğŸ“2025-01-05 9.1.2

- ä¿®å¤hashæ ¡éªŒå¼‚å¸¸ç»§ç»­æ‰§è¡Œæ›´æ–°é—®é¢˜
- è§£é™¤Commonç»„ä»¶å’ŒDifferentialç»„ä»¶ä¸Bowl / ClientCore / Coreå¼•ç”¨ï¼Œè§£å†³ç›¸äº’å‡çº§å‡ºç°dllå ç”¨é—®é¢˜ã€‚

- è¯´æ˜Commonå’ŒDifferentialä»…å­˜åœ¨äºGeneralUpdateè§£å†³æ–¹æ¡ˆä¸­æ›´æ–°è¿­ä»£ï¼Œä¸å†æ›´æ–°è‡³Nugetå¹³å°ã€‚Commonç»„ä»¶å’ŒDifferentialç»„ä»¶æ‰€æœ‰ç”¨çš„èƒ½åŠ›é€šè¿‡ä»£ç æ–‡ä»¶å¼•ç”¨çš„æ–¹å¼ç»§ç»­å­˜åœ¨äºBowl / ClientCore / Coreç»„ä»¶ä¸­ã€‚å¼€å‘è€…æ— éœ€å†å…³å¿ƒCommonå’ŒDifferentialç»„ä»¶æ˜¯å¦å¼•ç”¨ã€‚



## ğŸ“2025-01-04 9.1.0

- æ·»åŠ å±è”½æŒ‡å®šæ–‡ä»¶å¤¹è·³è¿‡åŠŸèƒ½ï¼ˆæŒ‡å®šå‚æ•°ä¼šæµè½¬Clientã€Upgradeï¼‰ã€‚
- æ·»åŠ httpè¯·æ±‚å¤´ä¼ å…¥Scheme å’Œ Tokenå‚æ•°ã€‚
- ä¿®å¤OSS Samples æ›´æ–°å¤±è´¥é—®é¢˜ã€‚
- ä¿®æ”¹OSS åŠŸèƒ½æ›´æ–°å®Œæˆä¸åˆ é™¤æ›´æ–°åŒ…é—®é¢˜ã€‚
- ä¿®å¤ Samples ä¸­ Client å’Œ Upgrade åªå¯åŠ¨Clientæ›´æ–°é—®é¢˜ã€‚ï¼ˆå‡ºç°å¾ªç¯æ›´æ–°çš„ç°è±¡æ˜¯å› ä¸ºæ²¡æœ‰ä¿®æ”¹æœ¬åœ°ç‰ˆæœ¬å·ï¼‰
- æ‰€æœ‰Sample ä»9.0.0å‡çº§åº“è‡³9.1.0ã€‚



## ğŸ“2024-11-28 9.0.0

- æ›´æ–°æ‰€æœ‰ç»„ä»¶C#è¯­æ³•å‡å‡çº§è‡³C#13ã€‚

- ä¼˜åŒ–ã€é‡æ„ã€ç²¾ç®€ä»£ç ï¼Œä»¥æœ€å°‘çš„ä»£ç å®ç°åŠŸèƒ½é™ä½ä»£ç é˜…è¯»éš¾åº¦ã€‚

- ç®€åŒ–äº†GeneralClientBootstrapçš„ä¼ å…¥å‚æ•°å¤æ‚åº¦ã€‚

- ç§»é™¤Strategyså‚æ•°è®¾ç½®ï¼Œå†…ç½®åœ¨ç»„ä»¶å†…å¯è‡ªæ¨æ–­æ‰€åœ¨æ“ä½œç³»ç»Ÿå¹³å°åˆ‡æ¢æ›´æ–°ç­–ç•¥ï¼Œå¼€å‘è€…æ— éœ€å†å…³å¿ƒæ›´æ–°ç­–ç•¥è®¾ç½®ã€‚

- æ–°å¢é©±åŠ¨æ›´æ–°ã€å¤‡ä»½ã€å®‰è£…åŠŸèƒ½ã€‚

- ä¼˜åŒ–äº†è‡ªåŠ¨å‡çº§æµç¨‹ï¼Œæ›´æ–°çŠ¶æ€çš„å››ç§å·¥ä½œæµï¼š

  1.å®¢æˆ·ç«¯éœ€è¦å‡çº§ã€å‡çº§ç«¯éœ€è¦å‡çº§ 

  2.å®¢æˆ·ç«¯ä¸éœ€è¦å‡çº§ã€å‡çº§ç«¯ä¸éœ€è¦å‡çº§ 

  3.å®¢æˆ·ç«¯ä¸éœ€è¦å‡çº§ã€å‡çº§ç«¯éœ€è¦å‡çº§ 

  4.å®¢æˆ·ç«¯éœ€è¦å‡çº§ã€å‡çº§ç«¯ä¸éœ€è¦å‡çº§

- å¦‚æœæ›´æ–°å¤±è´¥çš„ç‰ˆæœ¬å°†ä¼šå­˜å‚¨åœ¨æœ¬åœ°ï¼Œå›æ»šä¹‹åå†é‡åˆ°å¤±è´¥ç‰ˆæœ¬åˆ™è·³è¿‡æ›´æ–°ã€‚

- GeneralUpdateçš„OSSåŠŸèƒ½ç›®å‰ä»…æ”¯æŒwindowsï¼Œä»…æ”¯æŒzipå‹ç¼©æ ¼å¼ã€‚

- ç§»é™¤GeneralUpdateOSSé€šçŸ¥æ‰€æœ‰äº‹ä»¶ã€‚

- æ–°å¢GeneralUpdate.Bowlç»„ä»¶

- GeneralUpdate.BowlåŒ…å«å›æ»šã€ç›‘æµ‹ã€å¯¼å‡ºdumpåŠŸèƒ½ï¼ˆOnly windowsï¼Œlinuxä¼šé™†ç»­å¼€æ”¾ï¼‰ã€‚

- æ–°å¢GeneralUpdate.Commonç»„ä»¶

- ç§»é™¤GeneralUpdate.Zipç»„ä»¶

- ç§»é™¤GeneralUpdate.AspnetCoreç»„ä»¶

- ç§»é™¤MultiDownloadProgressChangedEventï¼Œå°†è¯¥äº‹ä»¶çš„é€šçŸ¥å†…å®¹åˆå¹¶è‡³MultiDownloadStatisticsEventã€‚

- ç§»é™¤é—è¨€åŠŸèƒ½ï¼Œç”±GeneralUpdate.Bowlä»£æ›¿ã€‚

- ç§»é™¤7zå‹ç¼©æ ¼å¼æ”¯æŒï¼Œä»…æ”¯æŒzipå‹ç¼©æ ¼å¼ã€‚

- ç§»é™¤ProgressTypeå‡ ç§å·¥ä½œæ¨¡å¼é€šçŸ¥äº‹ä»¶å‚æ•°ã€‚

- ç§»é™¤VersionHubï¼Œç”±UpgradeHubServiceæ›¿ä»£ï¼ˆæ¨é€åŠŸèƒ½ï¼‰ã€‚

- æ›´æ–°ç»„ä»¶å†…æ‰€æœ‰Hashå€¼ç›¸å…³æ ¡éªŒã€ç”Ÿæˆå‡ä¸ºSHA256ç®—æ³•ï¼Œç§»é™¤MD5ç®—æ³•ã€‚

- æ–°å¢æ›´æ–°å‰å¤‡ä»½å½“å‰ç¨‹åºæ‰€æœ‰æ–‡ä»¶å†…å®¹ã€‚

- æ”¯æŒUbuntuæ“ä½œç³»ç»Ÿã€‚

- å…¼å®¹å¹¶æ”¯æŒAOTç¼–è¯‘ï¼Œç§»é™¤æˆ–é‡æ„æ‰€æœ‰ä¸åˆ©äºAOTç¼–è¯‘æˆ–ä½¿ç”¨çš„ä»£ç ã€‚

- æ‰€æœ‰ç»„ä»¶ç‰ˆæœ¬å·è·Ÿéš.NET Coreçš„æ¡†æ¶ç‰ˆæœ¬å·ã€‚å¹¶ä¸”ç»Ÿä¸€å…±äº«ä¸€ä¸ªç‰ˆæœ¬å·ï¼Œä¸å†å„è‡ªç»´æŠ¤å•ç‹¬çš„ç‰ˆæœ¬å·ã€‚

- æ›´æ–°Sampleç¤ºä¾‹æ›´æ–°ï¼Œä½¿ç”¨batè„šæœ¬ä¸€é”®ç”Ÿæˆã€‚

- ä¿®å¤äº†è‹¥å¹²issueä¸­æå‡ºçš„bugã€‚

- è½¬ç§»GeneralUpdate.Maui.OSSå’ŒGeneralUpdate.OSSç±»åº“è‡³æ–°ä»“åº“GeneralUpdate.Mauiã€‚

- GeneralUpdate.Differentialç§»é™¤GeneralUpdate.Zipå¼•ç”¨ï¼Œå¹¶ä¸”ç§»é™¤æ‰€æœ‰å‹ç¼©åŒ…å¤„ç†èƒ½åŠ›ã€‚

- æ–°å¢å‡çº§æµç¨‹ä¸ŠæŠ¥æœåŠ¡å™¨å‡çº§çŠ¶æ€ï¼Œå‡çº§çŠ¶æ€ä¸ºå¾…æ›´æ–°ã€æ›´æ–°å¤±è´¥ã€æ›´æ–°æˆåŠŸã€‚

- é‡æ„GeneralUpdate.Toolsä¸ºAvaloniaç‰ˆæœ¬ï¼Œé€‚é…åœ¨Linuxæ“ä½œç³»ç»Ÿä¸Šåˆ¶ä½œå·®åˆ†è¡¥ä¸åŒ…ã€‚



## ğŸ“2023-08-05

åœ¨ä¼ä¸šäº§å“å‘å¸ƒåˆ°å¸‚åœºä¹‹å‰éœ€è¦å¯¹åŠŸèƒ½è¿›è¡Œæµ‹è¯•ï¼Œåœ¨å¤§éƒ¨åˆ†å…¬å¸é‡Œè‡ªåŠ¨å‡çº§åŠŸèƒ½ä¸åƒäº§å“åŠŸèƒ½ä¸€æ ·æœ‰éœ€æ±‚æ–‡æ¡£æˆ–è€…ä¸šåŠ¡è¯´æ˜ç­‰æ–‡æ¡£ã€‚é€šå¸¸çš„è¦æ±‚å°±æ˜¯èƒ½æ­£å¸¸å‡çº§å…¬å¸äº§å“æˆ–èƒ½å¢é‡æ›´æ–°èŠ‚çº¦æµé‡å³å¯ã€‚è¿™æ—¶å€™å¯¹æµ‹è¯•ç»éªŒä¸è¶³çš„äººå‘˜æ¥è¯´æµ‹è¯•ä¸å……åˆ†æˆ–è€…å¤§å®¶éƒ½æ²¡æœ‰è€ƒè™‘åˆ°å°†ä¼šé€ æˆå¾ˆå¤šéº»çƒ¦ã€‚ï¼ˆè¿™é‡Œåªæ˜¯æä¾›ä¸€ç§æµ‹è¯•çš„æ€è·¯ï¼Œå¹¶éä¸“ä¸šæµ‹è¯•æŒ‡å¯¼è¯·è¾©è¯çœ‹å¾…ï¼‰

1.æµ‹è¯•ç‰ˆæœ¬å‡çº§é¡ºåº

å‡è®¾å¸‚åœºä¸Šæ‰€æœ‰çš„å®¢æˆ·ç°åœ¨ä½¿ç”¨çš„ç¨‹åºç‰ˆæœ¬æ˜¯v1.0.0.0ï¼Œæˆ‘ä»¬å³å°†å‘å¸ƒv2.0.0.0ã€‚åœ¨å‘å¸ƒä¹‹å‰å°±éœ€è¦åœ¨æµ‹è¯•ç¯å¢ƒä¸­å°†ä¸¤ä¸ªç‰ˆæœ¬å‡çº§æµ‹è¯•ä¸€ä¸‹ã€‚

- ä¸‹è½½æ›´æ–°åŒ…æ—¶
- æ­£åœ¨æ›´æ–°æ–‡ä»¶æ—¶
- å¼ºåˆ¶ä¸­æ–­ç¨‹åºè¿è¡Œã€æ–­ç½‘ã€ç›´æ¥æ–­ç”µã€æ¨¡æ‹Ÿå¼±ç½‘ã€æ¨¡æ‹Ÿå´©æºƒç­‰

2.åŠ å¯†æ–‡ä»¶æ— æ³•å‡çº§

åœ¨GeneralUpdateä¸­åœ¨ä¸¤ä¸ªç‰ˆæœ¬ä¸­æå–äºŒè¿›åˆ¶å·®åˆ†æ›´æ–°è¡¥ä¸æ–‡ä»¶æ—¶ï¼Œä¼šå‡ºç°åŠ å¯†æ–‡ä»¶æ— æ³•è¢«å·®åˆ†ç®—æ³•è¯†åˆ«çš„æƒ…å†µè¿™ä¸ªæ—¶å€™éœ€è¦è€ƒè™‘åœ¨ç”Ÿæˆå·®åˆ†è¡¥ä¸åŒ…æ—¶ï¼Œå°†åŠ å¯†è¿‡çš„æ–‡ä»¶åŠ å…¥åˆ°ï¼ˆSetBlacklistï¼‰é»‘åå•ä¸­æˆ–è€…è€ƒè™‘ç›´æ¥è¦†ç›–ï¼ˆç›´æ¥æ‰“åœ¨å‹ç¼©åŒ…é‡Œï¼‰ã€‚

3.å¤±è´¥å›æ»šæˆ–è€…é‡æ–°å‡çº§ï¼Ÿ

è¿™æ–¹é¢ä¹Ÿæ˜¯ä¼ä¸šä¸­å¤§å®¶æœ€åœ¨æ„çš„ä¸€ç‚¹ï¼Œè‡ªåŠ¨å‡çº§è™½ç„¶èƒ½å¸¦æ¥è¯¸å¤šå¥½å¤„ã€‚ä½†æ˜¯å‡çº§å¤±è´¥ä¼šç›´æ¥å¯¼è‡´å®¢æˆ·ç«¯æ ¹æœ¬æ²¡æ³•ä½¿ç”¨è¿™æ˜¯éå¸¸è‡´å‘½çš„ï¼Œåç»­æˆ‘ä¼šè€ƒè™‘åœ¨GeneralUpdateä¸­æ–°å¢ä¸¤ç§ç­–ç•¥æ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚

- ç­–ç•¥ä¸€

å‡çº§ä¹‹å‰å°†éœ€è¦è¢«æ›´æ–°çš„æ–‡ä»¶æˆ–ç›®å½•è¿›è¡Œå¤‡ä»½ï¼Œå¦‚æœæ›´æ–°å¤±è´¥ç¬¬äºŒæ¬¡å¯åŠ¨åˆ™ä¼šå°†å¤‡ä»½æ–‡ä»¶è¿˜åŸè‡³åŸæ¥çš„ç›®å½•ï¼Œå¹¶å…³é—­è‡ªåŠ¨å‡çº§çš„å¼€å…³ä»¥é˜²æ­¢æ–‡ä»¶è¿˜åŸä¹‹åå†æ¬¡è¿›è¡Œè‡ªåŠ¨å‡çº§ã€‚

- ç­–ç•¥äºŒ

è¿™ä¸ªæ˜¯æˆ‘å†…å¿ƒä¸­æ¯”è¾ƒæ¨èçš„å‡çº§æ–¹å¼ï¼Œå› ä¸ºè‡ªåŠ¨å‡çº§ç¨‹åºçš„æ„ä¹‰å°±æ˜¯å‡çº§è€Œä¸æ˜¯å›æ»šã€‚ç›®å‰åˆæ­¥çš„æƒ³æ³•æ˜¯æ–°å¢é—è¨€æœºåˆ¶ã€‚ä¸ºè§£å†³åœ¨æ›´æ–°æ—¶é‡åˆ°å¼‚å¸¸æƒ…å†µï¼Œå¯¼è‡´æ–‡ä»¶æŸåæ›´æ–°çš„é—®é¢˜ã€‚1.æ¯æ¬¡æ›´æ–°å®Œæˆï¼Œéœ€è¿”å›ç»™æœåŠ¡å™¨æ›´æ–°çŠ¶æ€ã€‚å¦‚æœå®¢æˆ·ç«¯åœ¨30åˆ†é’Ÿå†…æ²¡æœ‰ä»»ä½•åé¦ˆåˆ™åˆ¤å®šä¸ºæ¯åæ€§æ›´æ–°å¤±è´¥ã€‚ï¼ˆæ–‡ä»¶æŸåï¼‰2.å‡çº§ç¨‹åºæ¯æ¬¡å¯åŠ¨æ—¶ä¼šè¯»å–ä¸Šä¸€æ¬¡æ›´æ–°çš„é—è¨€ï¼Œå¦‚æœä¸Šæ¬¡æ›´æ–°ä¸ºå¤±è´¥è‡ªåŠ¨åŒ–ä¸‹è½½ã€å®‰è£…å®¢æˆ·ç«¯å®‰è£…åŒ…ï¼ˆå‹ç¼©åŒ…ï¼‰3.æˆ–è€…æ–°å¢æ›´æ–°å®ˆæŠ¤è¿›ç¨‹æ¥æ”¶å®æ—¶æ¨é€è‡ªåŠ¨åŒ–ä¸‹è½½ã€å®‰è£…å®¢æˆ·ç«¯å®‰è£…åŒ…ï¼ˆå‹ç¼©åŒ…ï¼‰

4.é¡¹ç›®ç»“æ„è°ƒæ•´

å¦‚æœå¼€å‘äººå‘˜å¯¹é¡¹ç›®ç»“æ„å‘ç”Ÿäº†ä¸€äº›ç»“æ„æ€§è´¨çš„ä¿®æ”¹ã€‚ä¾‹å¦‚åŸºäºIoCæ€æƒ³æ­å»ºçš„å®¢æˆ·ç«¯ç¨‹åºï¼Œä¾‹å¦‚Prismæ¡†æ¶å¦‚æœå¼€å‘äººå‘˜æŠŠå…¶ä¸­çš„ä¸€ä¸ªModuleæ›´æ¢äº†æ–‡ä»¶å¤¹çš„ä½ç½®æˆ–è€…æ–‡ä»¶å¤¹åç§°ä¿®æ”¹äº†ï¼Œå¯¼è‡´ç”¨æˆ·çš„å®¢æˆ·ç«¯æ›´æ–°äº†ä¹‹åIoCå®¹å™¨å¯åŠ¨ä¹‹åæ‰¾ä¸åˆ°è¯¥DLLçš„å¼‚å¸¸æƒ…å†µã€‚æ›´æ–°æ—¶éœ€è¦è€ƒè™‘åˆ°æ–‡ä»¶è·¯å¾„å˜åŒ–çš„é—®é¢˜ã€‚æµ‹è¯•äººå‘˜ä¹Ÿæœ‰è´£ä»»ä¾‹è¡Œè¯¢é—®æ˜¯å¦æœ‰è¯¥ç§ç±»çš„å˜åŒ–ã€‚

5.ä½œä¸ºæœ€åé—­ç¯æµç¨‹å†æµ‹è¯•

è¿™ä¸ªäº‹é¡¹æ˜¯éå¸¸éœ€è¦æ³¨æ„çš„ï¼Œå¦‚æœå‰é¢å°±æŠŠè‡ªåŠ¨å‡çº§å…ˆæµ‹è¯•äº†ã€‚å¦‚æœåç»­æœ‰bugä¿®å¤æˆ–è€…å…¶ä»–å˜åŠ¨éƒ½æœ‰å¯èƒ½ä¼šé€ æˆæœªçŸ¥çš„å¼‚å¸¸æƒ…å†µå‡ºç°ã€‚æ‰€ä»¥ä½œä¸ºæœ€åçš„é—­ç¯æµç¨‹è¿›è¡Œæµ‹è¯•æ˜¯æ¯”è¾ƒæ¨èçš„ï¼ˆå¦‚æœ‰ç‰¹æ®Šæƒ…å†µæŒ‰éœ€è¦è°ƒæ•´å³å¯ï¼‰ã€‚

6.å¼±ç½‘ç¯å¢ƒæµ‹è¯•

å¼±ç½‘ç¯å¢ƒæ¨¡æ‹Ÿå¯ä»¥å€ŸåŠ©NetLimiterå’ŒClumsyæ¥è¿›è¡Œæµ‹è¯•ï¼Œå…·ä½“ä½¿ç”¨æ–¹æ³•å¯ä»¥å‚è€ƒæˆ‘çš„è¿™ç¯‡æ–‡ç« ã€‚

[https://mp.weixin.qq.com/s?__biz=MzI5MTg4NzIyNg==&mid=2247486705&idx=1&sn=b2eac543ea7f738bdbe8c3cc63da3488&chksm=ec088de4db7f04f25e5603d2309d61279b0f94ee6eef34129801755a86cf406f863896214b3c&token=1809721461&lang=zh_CN#rd](https://mp.weixin.qq.com/s?__biz=MzI5MTg4NzIyNg==&mid=2247486705&idx=1&sn=b2eac543ea7f738bdbe8c3cc63da3488&chksm=ec088de4db7f04f25e5603d2309d61279b0f94ee6eef34129801755a86cf406f863896214b3c&token=1809721461&lang=zh_CN&scene=21#wechat_redirect)

7.ç°åº¦å‘å¸ƒ

ç‰ˆæœ¬å‘å¸ƒä¹‹å‰å°±éœ€è¦åšå¥½æµ‹è¯•ã€‚

- å¦‚æœé¢å¯¹çš„å®¢æˆ·ç¾¤ä½“åºå¤§åˆ™éœ€è¦å°èŒƒå›´çš„ç°åº¦å‘å¸ƒï¼Œå¦‚æœæ²¡æœ‰é—®é¢˜å†é€‰æ‹©å‘å¸ƒç»™å¸‚åœºä¸Šæ‰€æœ‰å®¢æˆ·ã€‚
- å¦‚æœæ˜¯ç°åº¦å‡çº§ç‰ˆæœ¬ï¼Œè¿™ä¸ªæ—¶å€™å°±ä¸è¦è®¾ç½®ä¸ºå¼ºåˆ¶æ›´æ–°çš„ç‰ˆæœ¬äº†ã€‚è®©ç”¨æˆ·è‡ªå·±é€‰æ‹©æ˜¯å¦å‡çº§ã€‚

8.ç²¾å‡†å‡çº§

åœ¨GeneralUpdateä¸­ç›®å‰å·²æœ‰çš„åŸºäºSignal Ræ¥æ”¶æ¨é€æœ€æ–°ç‰ˆæœ¬æ›´æ–°çš„æ–¹å¼ã€‚å‡è®¾åœ¨å¸‚åœºä¸Šæœ‰å¾ˆå¤šå®¢æˆ·ï¼Œæ¯ä¸ªå®¢æˆ·æœ‰å¾ˆå¤šå°è®¾å¤‡ã€‚é‚£ä¹ˆå…¶ä¸­å®¢æˆ·Aæœ‰10å°ç”µè„‘ï¼Œåªæœ‰å…¶ä¸­ä¸€å°ç”µè„‘å› ä¸ºç¡¬ä»¶æˆ–è€…è½¯ä»¶ç¯å¢ƒå‡ºç°äº†é—®é¢˜å¯¼è‡´å®¢æˆ·ç«¯çš„åŠŸèƒ½å¼‚å¸¸ã€‚è¿™ä¸ªæ—¶å€™éœ€è¦ç´§æ€¥é’ˆå¯¹è¯¥å°è®¾å¤‡çš„æƒ…å†µè¿›è¡Œä¿®å¤ï¼Œè¿™ä¸ªæ—¶å€™å¹¶ä¸æ¸…æ¥šè¿™ä¸ªä¿®æ”¹ä¼šä¸ä¼šå¯¹ç°åœ¨å·²ç»æ­£å¸¸è¿è¡Œçš„å®¢æˆ·ç«¯ç¨‹åºæœ‰å½±å“ã€‚è¿™ä¸ªæ—¶å€™å¯ä»¥è€ƒè™‘ä½¿ç”¨ä¸€å¯¹ä¸€çš„å‡çº§æ–¹å¼ç²¾å‡†å‡çº§æŸå°å‡ºé—®é¢˜çš„ç”µè„‘ã€‚

9.è€é…ç½®å…¼å®¹æ–°ç‰ˆæœ¬

åœ¨å¸‚åœºä¸Šå¦‚æœå­˜åœ¨å„ä¸ªåˆ†æ”¯çš„ç‰ˆæœ¬æ—¶ï¼Œæ¯æ¬¡è‡ªåŠ¨æ›´æ–°å‡çº§è¿˜éœ€è¦è€ƒè™‘åˆ°æœ¬åœ°é…ç½®æ–‡ä»¶çš„é—®é¢˜ã€‚å¦‚æœå‡çº§åˆ°æ–°ç‰ˆæœ¬çš„ç¨‹åºä¹‹åéœ€è¦è¯»é…ç½®æ–‡ä»¶è¿™ä¸ªæ—¶å€™ï¼Œè€ç‰ˆæœ¬çš„é…ç½®æ–‡ä»¶å…¼å®¹ä¸äº†ä¹Ÿä¼šé€ æˆé—®é¢˜ã€‚è¿™ä¸ªæ—¶å€™æµ‹è¯•äººå‘˜ä¹Ÿéœ€è¦æ³¨æ„è¯¥ç§åœºæ™¯ã€‚

è§„é¿è¿™ç§é—®é¢˜çš„æ–¹å¼å¯ä»¥æŠŠå¤§éƒ¨åˆ†å®¹æ˜“å˜åŠ¨çš„é…ç½®æ”¾åˆ°æœåŠ¡ç«¯æ¯æ¬¡ç™»å½•çš„æ—¶å€™å»è¯»å–ã€‚æŠŠä¸å®¹æ˜“å˜åŒ–çš„é…ç½®ä¿å­˜åˆ°æœ¬åœ°ã€‚

10.è‡ªåŠ¨åŒ–æµ‹è¯•

è‡ªåŠ¨å‡çº§çš„è‡ªåŠ¨æµ‹è¯•åŒ–æµ‹è¯•çš„è„šæœ¬ç¼–å†™ä¹Ÿéå¸¸é‡è¦ï¼Œåœ¨å¤šåˆ†æ”¯ã€å¤šç‰ˆæœ¬çš„å‡çº§æµ‹è¯•ä¸­èŠ‚çœæ—¶é—´,å¢åŠ æµ‹è¯•çš„å‡†ç¡®æ€§ã€‚



## ğŸ“2023-07-23

å¼€å‘è€…æé—®ï¼š

- ï¼ˆ1ï¼‰åœ¨æ›´æ–°è¿‡ç¨‹ä¸­å‡ºç°äº†æ–­ç½‘ã€æ–­ç”µã€ç”µè„‘æ­»æœºã€çªç„¶è“å±ã€ç¨‹åºå‡æ­»ç­‰æ„å¤–æƒ…å†µï¼Œå¯¼è‡´åº”ç”¨ç¨‹åºæ— æ³•æ­£å¸¸è¿›è¡Œæ›´æ–°æˆ–è€…æ— æ³•æ­£å¸¸å¯åŠ¨å¦‚ä½•è§£å†³ï¼Ÿèƒ½å¦è®©æ›´æ–°ç¨‹åºå›æ»šåˆ°è¿™æ¬¡æ›´æ–°ä¹‹å‰ï¼Ÿ

ç­”ï¼šè¿™ä¸ªé—®é¢˜åˆ†ä¸¤å—å›ç­”ï¼Œï¼ˆ1ï¼‰æ„å¤–æƒ…å†µå¯ä»¥å°è¯•é‡å¯åº”ç”¨ç¨‹åºæ–­ç‚¹ä¸‹è½½æ›´æ–°ï¼Œç›®å‰çš„æƒ…å†µæ¥è¯´å¦‚æœåœ¨æ›´æ–°è¿‡ç¨‹ä¸­å‡ºç°æ–‡ä»¶æŸåæ— æ³•åªèƒ½é‡æ–°å®‰è£…ã€‚åç»­ä¼šè€ƒè™‘å¢åŠ ä¸€ç§æœºåˆ¶å¤„ç†æ›´æ–°å¼‚å¸¸æƒ…å†µæ— æ³•å¯åŠ¨å®¢æˆ·ç«¯åº”ç”¨ç¨‹åºçš„é—®é¢˜ã€‚ï¼ˆ2ï¼‰ä¸èƒ½ï¼Œå› ä¸ºç›®å‰çš„æƒ³æ³•æ¥è¯´è‡ªåŠ¨å‡çº§ç¨‹åºçš„æ ¸å¿ƒæ„ä¹‰å°±æ˜¯å‡çº§ï¼Œå¦‚æœå›æ»šå›å»äº†å‡çº§å¯èƒ½å°±å¤±å»äº†æ„ä¹‰ã€‚å¯èƒ½ä¼šå¸Œæœ›åŠæ—¶å‘ç°é—®é¢˜ï¼Œç„¶åç´§æ€¥æ›´æ–°ä¸€ä¸ªå®‰å…¨çš„æ›´æ–°åŒ…è®©å®¢æˆ·ç«¯é€ç‰ˆæœ¬æ›´æ–°ç›´åˆ°æˆåŠŸã€‚



- ï¼ˆ2ï¼‰å¦‚æœæ›´æ–°åŒ…æ‰“åŒ…æœ¬èº«ï¼ˆæ›´æ–°åŒ…é‡Œæœ¬èº«å°±æœ‰å¼‚å¸¸æ–‡ä»¶ï¼‰å°±æœ‰é—®é¢˜ï¼Œæ›´æ–°å®Œæˆä¹‹åç¨‹åºæ— æ³•æ­£å¸¸å¯åŠ¨ã€‚èƒ½ä¸èƒ½å›æ»šæˆ–è€…å¤‡ä»½ï¼Ÿ

 ç­”ï¼šä¸èƒ½ï¼Œåœ¨è¯¥ç‰ˆæœ¬å‘å¸ƒä¹‹å‰å°±éœ€è¦åšå¥½æµ‹è¯•ã€‚å¦‚æœé¢å¯¹çš„å®¢æˆ·ç¾¤ä½“åºå¤§åˆ™éœ€è¦å°èŒƒå›´çš„ç°åº¦å‘å¸ƒï¼Œå¦‚æœæ²¡æœ‰é—®é¢˜å†é€‰æ‹©å‘å¸ƒç»™å¸‚åœºä¸Šæ‰€æœ‰å®¢æˆ·ã€‚



- ï¼ˆ3ï¼‰å¦‚æœå®¢æˆ·ç«¯æœ¬åœ°ä¿å­˜äº†ä¸€äº›æ•°æ®æ–‡ä»¶ï¼Œåœ¨ä¿ç•™ä¹‹å‰çš„æ•°æ®çš„æ–‡ä»¶åŸºç¡€ä¸Šéœ€è¦æ–°å¢ä¸€äº›å†…å®¹ï¼Œä¾‹å¦‚sqliteçš„.dbæ–‡ä»¶æ›´æ–°ä¹‹åè¢«ä¹‹å‰çš„.dbæ–‡ä»¶è¢«è¦†ç›–ï¼Œå¦‚ä½•è§£å†³ï¼Ÿæˆ–è€…å¢é‡æ›´æ–°æ˜¯å¦å¯ä»¥æ­£å¸¸æ›´æ–°è¿™äº›æ–‡ä»¶ï¼Ÿ

ç­”ï¼šä¹‹å‰æœ‰å¼€å‘è¿‡è¿™æ ·çš„åŠŸèƒ½ï¼Œæ•ˆæœä¸å¥½æš‚æ—¶ä¸‹çº¿äº†ï¼›åç»­éœ€è¦é‡æ–°è®¾è®¡å†å¯ç”¨è¯¥ç±»åŠŸèƒ½ã€‚ç»„ä»¶ç›®å‰çš„åŠŸèƒ½å®Œæˆåº¦æš‚æ—¶æ— æ³•è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œåªèƒ½è¦†ç›–ã€‚å¢é‡æ›´æ–°ä¹Ÿæœ‰æå¤§çš„å¯èƒ½æ›´æ–°ä¸äº†è¿™ç§æƒ…å†µã€‚





## ğŸ“2023-04-23

ä½¿ç”¨æŠ€æœ¯æ›´æ–°

é»‘åå•åŠŸèƒ½ï¼ŒOSSæ–°åŠŸèƒ½å‘å¸ƒï¼Œé’ˆå¯¹windowså’Œ.NET MAUI Android ç‰ˆæœ¬ã€‚ä¿®å¤äº†éƒ¨åˆ†bugå’Œé‡æ„äº†ç»„ä»¶æ•´ä½“çš„äº‹ä»¶ç®¡ç†é€šçŸ¥æœºåˆ¶ã€‚

1.å‘å¸ƒå†…å®¹

| ç»„ä»¶åç§°                   | ç‰ˆæœ¬å·ï¼ˆoldï¼‰ | ç‰ˆæœ¬å·ï¼ˆnewï¼‰ | çŠ¶æ€   |
| -------------------------- | ------------- | ------------- | ------ |
| GeneralUpdate.AspNetCore   | 1.4.1         | -             | -      |
| GeneralUpdate.ClientCore   | 2.8.9         | 2.12.9        | æ–°ç‰ˆæœ¬ |
| GeneralUpdate.Core         | 4.11.18       | 4.14.18       | æ–°ç‰ˆæœ¬ |
| GeneralUpdate.Differential | 1.3.0         | 1.4.1         | æ–°ç‰ˆæœ¬ |
| GeneralUpdate.Zip          | 1.3.0         | -             | -      |
| GeneralUpdate.Tool         | 2.2.5         | 2.3.5         | æ–°ç‰ˆæœ¬ |
| GeneralUpdate.Single       | 1.0.0         | -             | -      |
| GeneralUpdate.Maui.OSS     | 1.0.0         | 1.0.0         | æ–°ç‰ˆæœ¬ |



ã€1ã€‘ç»„ä»¶GeneralUpdate.ClientCore

1.æ–°å¢OSSæ›´æ–°åŠŸèƒ½

2.æ–°å¢é»‘åå•åŠŸèƒ½

3.é‡æ„äº‹ä»¶ï¼Œæ·»åŠ äº‹ä»¶ç®¡ç†æœºåˆ¶

4.ä¿®å¤ï¼Œå¢é‡åŒ…åªèƒ½è¯†åˆ«æ–°å¢ï¼Œä¸èƒ½è¯†åˆ«åˆ é™¤



ã€2ã€‘ç»„ä»¶GeneralUpdate.Core

1.æ–°å¢OSSæ›´æ–°åŠŸèƒ½

2.é‡æ„äº‹ä»¶ï¼Œæ·»åŠ äº‹ä»¶ç®¡ç†æœºåˆ¶

3.ä¿®å¤ï¼Œå¢é‡åŒ…åªèƒ½è¯†åˆ«æ–°å¢ï¼Œä¸èƒ½è¯†åˆ«åˆ é™¤



ã€3ã€‘ç»„ä»¶GeneralUpdate.Differential

1.ä¿®å¤ï¼Œå¢é‡åŒ…åªèƒ½è¯†åˆ«æ–°å¢ï¼Œä¸èƒ½è¯†åˆ«åˆ é™¤

2.1 ç»„ä»¶GeneralUpdate.ClientCoreã€ç»„ä»¶GeneralUpdate.Coreæ”¹åŠ¨

1.äº‹ä»¶è®¢é˜…æœºåˆ¶é‡æ„ä¹‹åä¸å†ä½¿ç”¨event+=è®¢é˜…æ–¹å¼ï¼Œé€šè¿‡äº‹ä»¶EventMangeræ·»åŠ äº‹ä»¶ç›‘å¬ã€‚å¯¹äºå¼€å‘è€…æ¥è¯´åªéœ€è¦è½»å¾®çš„ä»£ç ä¿®æ”¹å³å¯é€‚åº”æ–°ç‰ˆæœ¬ã€‚å¯¹äºç»„ä»¶æœ¬èº«è€Œè¨€å‡å°‘å¤§é‡çš„ä»£ç ï¼Œç»„åˆä¼˜äºç»§æ‰¿ã€‚

2.æ·»åŠ é»‘åå•ç®¡ç†SetBlacklistæ–¹æ³•ï¼Œå¯ä»¥è®¾ç½®ä¸æƒ³æ›´æ–°çš„æŸä¸ªå…·ä½“æ–‡ä»¶æˆ–è€…æŸä¸ªç±»å‹çš„æ–‡ä»¶ï¼Œç»„ä»¶å†…ç½®é»˜è®¤é»‘åå•æ–‡ä»¶ï¼š{ "Newtonsoft.Json.dll" } é»˜è®¤é»‘åå•æ–‡ä»¶æ‰©å±•åï¼š{ ".patch", ".7z", ".zip", ".rar", ".tar" , ".json" }ã€‚

```c#
           Task.Run(async () =>
          {
               //ClientStrategyè¯¥æ›´æ–°ç­–ç•¥å°†å®Œæˆ1.è‡ªåŠ¨å‡çº§ç»„ä»¶è‡ªæ›´æ–° 2.å¯åŠ¨æ›´æ–°ç»„ä»¶ 3.é…ç½®å¥½ClientParameteræ— éœ€å†åƒä¹‹å‰çš„ç‰ˆæœ¬å†™argsæ•°ç»„è¿›ç¨‹é€šè®¯äº†ã€‚
               //generalClientBootstrap.Config(baseUrl, "B8A7FADD-386C-46B0-B283-C9F963420C7C").
               var configinfo = GetWindowsConfiginfo();
               var generalClientBootstrap = await new GeneralClientBootstrap()
               //å•ä¸ªæˆ–å¤šä¸ªæ›´æ–°åŒ…ä¸‹è½½é€šçŸ¥äº‹ä»¶
              .AddListenerMultiDownloadProgress(OnMultiDownloadProgressChanged)
               //å•ä¸ªæˆ–å¤šä¸ªæ›´æ–°åŒ…ä¸‹è½½é€Ÿåº¦ã€å‰©ä½™ä¸‹è½½äº‹ä»¶ã€å½“å‰ä¸‹è½½ç‰ˆæœ¬ä¿¡æ¯é€šçŸ¥äº‹ä»¶
              .AddListenerMultiDownloadStatistics(OnMultiDownloadStatistics)
               //å•ä¸ªæˆ–å¤šä¸ªæ›´æ–°åŒ…ä¸‹è½½å®Œæˆ
              .AddListenerMultiDownloadCompleted(OnMultiDownloadCompleted)
               //å®Œæˆæ‰€æœ‰çš„ä¸‹è½½ä»»åŠ¡é€šçŸ¥
              .AddListenerMultiAllDownloadCompleted(OnMultiAllDownloadCompleted)
               //ä¸‹è½½è¿‡ç¨‹å‡ºç°çš„å¼‚å¸¸é€šçŸ¥
              .AddListenerMultiDownloadError(OnMultiDownloadError)
               //æ•´ä¸ªæ›´æ–°è¿‡ç¨‹å‡ºç°çš„ä»»ä½•é—®é¢˜éƒ½ä¼šé€šè¿‡è¿™ä¸ªäº‹ä»¶é€šçŸ¥
              .AddListenerException(OnException)
              .Config(configinfo)
              .Option(UpdateOption.DownloadTimeOut, 60)
              .Option(UpdateOption.Encoding, Encoding.Default)
              .Option(UpdateOption.Format, Format.ZIP)
              .Strategy<WindowsStrategy>()
               //æ³¨å…¥ä¸€ä¸ªfuncè®©ç”¨æˆ·å†³å®šæ˜¯å¦è·³è¿‡æœ¬æ¬¡æ›´æ–°ï¼Œå¦‚æœæ˜¯å¼ºåˆ¶æ›´æ–°åˆ™ä¸ç”Ÿæ•ˆ
              .SetCustomOption(ShowCustomOption)
               //é»˜è®¤é»‘åå•æ–‡ä»¶ï¼š{ "Newtonsoft.Json.dll" } é»˜è®¤é»‘åå•æ–‡ä»¶æ‰©å±•åï¼š{ ".patch", ".7z", ".zip", ".rar", ".tar" , ".json" }
               //å¦‚æœä¸éœ€è¦æ‰©å±•ï¼Œéœ€è¦é‡æ–°ä¼ å…¥é»‘åå•é›†åˆæ¥è¦†ç›–ã€‚
              .SetBlacklist(GetBlackFiles(), GetBlackFormats())
              .LaunchTaskAsync();
          });
```



1.æ–°å¢OSSåŠŸèƒ½

OSSçš„å…¨ç§°æ˜¯å¯¹è±¡å­˜å‚¨æœåŠ¡ï¼ˆObject Storage Serviceï¼‰ï¼ŒåšæœåŠ¡ç«¯æŠ€æœ¯æ ˆå¼€å‘çš„å°ä¼™ä¼´è‚¯å®šå¯¹è¿™ä¸ªä¸é™Œç”Ÿåœ¨å„å¤§äº‘æœåŠ¡å™¨å‚å•†éƒ½ä¼šæä¾›ç±»ä¼¼çš„æœåŠ¡,è¯´ç®€å•ç‚¹å°±æ˜¯ä¸€ä¸ªæ–‡ä»¶æœåŠ¡å™¨ã€‚ä¾‹å¦‚ï¼šé˜¿é‡Œäº‘OSSã€è…¾è®¯äº‘COSã€åä¸ºäº‘OBSï¼Œå…¶å®å®ƒä»¬åªæ˜¯åå­—ä¸ä¸€æ ·åŠŸèƒ½æœåŠ¡éƒ½å·®ä¸å¤šã€‚ç„¶åæœ¬æ›´æ–°ç»„ä»¶æ–°åŠŸèƒ½çš„å®ç°æ€è·¯éå¸¸ç›¸ä¼¼é‚£ä¹ˆå°±é€‰æ‹©äº†OSSæ¥ä¸ºè¯¥åŠŸèƒ½å‘½åï¼Œè€Œä¸”æ–¹ä¾¿å¼€å‘è€…ä¸€çœ¼èƒ½getåˆ°è¿™ä¸ªåŠŸèƒ½çš„ä½œç”¨ï¼ˆéœ€è¦ä½¿ç”¨ç»„ä»¶GeneralUpdate.ClientCoreã€GeneralUpdate.Coreï¼‰ã€‚



2.GeneralUpdate.OSSè¿è¡ŒåŸç†

1.å‡†å¤‡version.jsonç‰ˆæœ¬ä¿¡æ¯é…ç½®æ–‡ä»¶ï¼Œæ›´æ–°æ–‡ä»¶ï¼ˆupdate.zipï¼‰æ›´æ–°æ–‡ä»¶å’Œä¹‹å‰çš„æ‰“åŒ…æ–¹å¼ä¸€æ ·ã€‚

```json
[
{
"PubTime": 1680443321,
"Name": "generalupdate.ossclient",
"MD5": "9bf414990a67e74f11752d03f49b15d8",
"Version": "1.0.4",
"Url": "http://192.168.50.203/update.zip"
},
{
"PubTime": 1680444916,
"Name": "generalupdate.ossclient",
"MD5": "JXC122DFXCZXZNMRFf11752d03f49b15d8",
"Version": "1.0.5",
"Url": "http://192.168.50.203/update2.zip"
}
]
```

2.Clientå¯åŠ¨æ—¶ç›´æ¥è¯·æ±‚OSSæœåŠ¡å™¨æˆ–æ–‡ä»¶æœåŠ¡å™¨ï¼Œä¸‹è½½version.jsonæ–‡ä»¶ã€‚

3.ä¸‹è½½åˆ°æœ¬åœ°ä¹‹åè§£æç‰ˆæœ¬ä¿¡æ¯å†…å®¹åˆ¤æ–­æ˜¯å¦éœ€è¦æ›´æ–°ï¼Œå¦‚æœå°†ä¿¡æ¯é€šè¿‡è¿›ç¨‹å¯åŠ¨ä¼ é€’Upgradeï¼ˆClientè‡ªæˆ‘å…³é—­ï¼‰ã€‚

4.Upgradeå¯åŠ¨ä¹‹åç›´æ¥å»ä¸‹è½½update.zipï¼Œä¸‹è½½åˆ°æœ¬åœ°ä¹‹åç›´æ¥è§£å‹è¦†ç›–æœ¬åœ°æ–‡ä»¶ã€‚

5.Upgradeæ›´æ–°å®Œæˆä¹‹åæŠŠClientå¯åŠ¨èµ·æ¥ï¼Œè‡ªæˆ‘å…³é—­ã€‚æ›´æ–°ç»“æŸã€‚

GeneralUpdateOSSçš„åŠŸèƒ½å’ŒGeneralUpdateBootstrapåŠŸèƒ½å¯¹æ¯”æ¥è¯´ï¼Œä½¿ç”¨çš„é—¨æ§›éå¸¸ä½å¦‚æœå…¬å¸å¯¹è‡ªåŠ¨æ›´æ–°çš„è¦æ±‚ä¸é«˜çš„è¯å¯ä»¥ä½¿ç”¨è¿™ä¸ªåŠŸèƒ½ã€‚ä¸€å¥è¯æ¦‚æ‹¬è¿™ä¸ªåŠŸèƒ½å°±æ˜¯ä¸‹è½½version.jsonæ ¹æ®æ–‡ä»¶é‡Œçš„å†…å®¹å»é€ç‰ˆæœ¬ä¸‹è½½æ›´æ–°åŒ…ï¼Œä¸‹è½½ä¸‹æ¥ä¹‹åç›´æ¥è§£å‹æ›´æ–°å°±ç»“æŸäº†ã€‚



3.å¿«é€Ÿå¯åŠ¨

Clientï¼ˆä¸»å®¢æˆ·ç«¯ï¼‰ä½¿ç”¨ä»£ç ç¤ºä¾‹ï¼š

```c#
Task.Run(async () =>
{
    var url = "http://192.168.50.203";
    var appName = "GeneralUpdate.Client";
    var version = "1.0.0.0";
    var versionFileName = "version.json";
    ParamsOSS @params = new ParamsOSS(url, appName, version, versionFileName);
    await GeneralClientOSS.Start(@params);
});
```



Upgrade(å‡çº§åŠ©æ‰‹)ä½¿ç”¨ä»£ç ç¤ºä¾‹ï¼š

```c#
private static void Main(string[] args)
{
  Task.Run(async () =>
  {
     //var url = "http://192.168.50.203";
     //var appName = "GeneralUpdate.Client";
     //var version = "1.0.0";
     //var versionFileName = "version.json";
     //SerializeUtil.Deserialize<ParamsOSS>(args[0]);
     //ParamsOSS @params = new ParamsOSS(url, appName, version, versionFileName);
     ParamsOSS @params = SerializeUtil.Deserialize<ParamsOSS>(args[0]);
     await GeneralUpdateOSS.Start<OSSStrategy>(@params,Encoding.Default);
  });
}
```



4.äº‹ä»¶é€šçŸ¥è®¢é˜…

åœ¨OSSçš„æ›´æ–°è¿‡ç¨‹ä¸­ï¼Œä¿ç•™äº†æ›´æ–°äº‹ä»¶çš„å‚æ•°å’Œä¹‹å‰ä¸€æ ·ã€‚

```c#
//code...
GeneralUpdateOSS.AddListenerMultiDownloadStatistics(OnMultiDownloadStatistics);

private static void OnMultiDownloadStatistics(object sender, MultiDownloadStatisticsEventArgs e)
{
  Console.WriteLine($" {e.Speed} , {e.Remaining.ToShortTimeString()}");
}
```



2.3  .NET MAUI OSS

MAUI OSSåŠŸèƒ½ä»‹ç»å’Œ 11.OSSä¸­ä»‹ç»çš„æ˜¯ä¸€æ ·çš„ã€‚ä½†æ˜¯å®ƒæ˜¯é’ˆå¯¹.NET MAUIç¼–å†™çš„æ›´æ–°ï¼Œä½¿ç”¨çš„ç»„ä»¶åº“æ˜¯GeneralUpdate.Maui.OSSã€‚ç›®å‰åªå®ç°äº†MAUI Andoridå¹³å°çš„è‡ªåŠ¨æ›´æ–°ã€‚

1.å‡†å¤‡version.jsonç‰ˆæœ¬ä¿¡æ¯é…ç½®æ–‡ä»¶ï¼Œæ›´æ–°æ–‡ä»¶ï¼ˆupdate.apkï¼‰æ›´æ–°æ–‡ä»¶å°±ç›´æ¥æ˜¯æ–°ç‰ˆæœ¬çš„apkäº†(æˆ–.abb)ã€‚

```json
{
"PubTime": 1680444916,
"Name": "com.companyname.generalupdate.ossclient",
"MD5": "9bf414990a67e74f11752d03f49b15d8",
"Version": "1.0.5",
"Url": "http://192.168.50.203/com.companyname.generalupdate.ossclient.apk"
}
```

2.Clientå¯åŠ¨æ—¶ç›´æ¥è¯·æ±‚OSSæœåŠ¡å™¨æˆ–æ–‡ä»¶æœåŠ¡å™¨ï¼Œä¸‹è½½version.jsonæ–‡ä»¶ã€‚

3.ä¸‹è½½åˆ°æœ¬åœ°ä¹‹åè§£æç‰ˆæœ¬ä¿¡æ¯å†…å®¹ï¼Œåˆ¤æ–­æ˜¯å¦éœ€è¦æ›´æ–°ã€‚

4.éœ€è¦æ›´æ–°åˆ™ä¸‹è½½update.apkã€‚

5.ä¸‹è½½å®Œæˆä¹‹åæ‰§è¡Œå®‰è£…ï¼Œè¿™ä¸€æ­¥å°±äº¤ç»™äº†å®‰å“æ“ä½œç³»ç»Ÿæ‰§è¡Œã€‚æ‰§è¡Œå®Œæˆä¹‹åè¿è¡Œæ–°ç‰ˆæœ¬appã€‚



2.å¿«é€Ÿå¯åŠ¨

```c#
//http://192.168.50.203/version.json
string url = "http://192.168.50.203";
string appName = "MainApplication.exe";
string currentVersion = "1.1.1.1";
string versionFileName = "versions.json";
GeneralUpdateOSS.AddListenerDownloadProcess(OnOSSDownload);
GeneralUpdateOSS.AddListenerException(OnException);
await GeneralUpdateOSS.Start<Strategy>(new ParamsAndroid(url, appName, "123456789", currentVersion, versionFileName));
```



3.äº‹ä»¶é€šçŸ¥è®¢é˜…

```c#
GeneralUpdateOSS.AddListenerDownloadProcess(OnOSSDownload);
GeneralUpdateOSS.AddListenerException(OnException);

private void OnOSSDownload(object sender, OSSDownloadArgs e)
{
   Console.WriteLine($"{e.ReadLength},{e.TotalLength}");
}

private void OnException(object sender, ExceptionEventArgs exception)
{
   Console.WriteLine(exception.Exception.Message);
}
```



4. .NET MAUI Android ç›¸å…³ç–‘é—®å¤„ç†å¼•å¯¼æ–‡ç« 

https://www.cnblogs.com/MASA/p/16612541.html

https://learn.microsoft.com/zh-cn/dotnet/maui/android/deployment/?view=net-maui-7.0

https://stackoverflow.com/questions/45940861/android-8-cleartext-http-traffic-not-permitted

https://note.youdao.com/ynoteshare/mobile.html?id=5c5d5cf8fe1d67419b09024255ff239c



5.è¿è¡Œæ•ˆæœ

ç›®å‰å·²è¿è¡Œæµ‹è¯•æœºå‹ã€å¹³å° ã€‚

1.åœ¨åä¸ºè£è€€Px30éé¸¿è’™ç³»ç»Ÿæ‰‹æœºå¯è¿è¡Œã€‚

2.Visual studio 2022 preview Pixe 5 - API33 (Android 13.0 - API 33) å¯è¿è¡Œã€‚





## ğŸ“2023-01-17

å¼€æºé¡¹ç›®è°ƒæ•´

åœ¨githubå’Œgiteeçš„ä¸¤ä¸ªå¼€æºå¹³å°åˆ†åˆ«å»ºç«‹äº†Generalå¼€æºç»„ç»‡ï¼Œä¼šå°†å…·æœ‰ä¸€å®šä»£ç è´¡çŒ®çš„å°ä¼™ä¼´é‚€è¯·åˆ°ç»„ç»‡ä¸­æ¥å¹¶åˆ†é…å¥–åŠ±ã€‚

å°†åŸæœ‰çš„GeneralUpdate æ‹†åˆ†æˆäº†ä¸‰ä¸ªé¡¹ç›®ï¼Œåˆ†åˆ«æ˜¯ï¼š

- https://gitee.com/GeneralLibrary

- è‡ªåŠ¨å‡çº§é¡¹ç›® https://gitee.com/GeneralLibrary/GeneralUpdate
- å·®åˆ†è¡¥ä¸åŒ…æ‰“åŒ…å·¥å…· https://gitee.com/GeneralLibrary/GeneralUpdate.Tools
- ä½¿ç”¨ç¤ºä¾‹ https://gitee.com/GeneralLibrary/GeneralUpdate-Samples



## ğŸ“2022-10-09

å‘å¸ƒå†…å®¹

| ç»„ä»¶åç§°                   | ç‰ˆæœ¬å·ï¼ˆoldï¼‰ | ç‰ˆæœ¬å·ï¼ˆnewï¼‰ | çŠ¶æ€ |
| -------------------------- | ------------- | ------------- | ---- |
| GeneralUpdate.AspNetCore   | 1.1.0         | 1.4.1         | æ­£å¸¸ |
| GeneralUpdate.ClientCore   | 2.3.6         | 2.8.9         | æ­£å¸¸ |
| GeneralUpdate.Core         | 4.10.12       | 4.11.18       | æ­£å¸¸ |
| GeneralUpdate.Differential | 1.0.0         | 1.3.0         | æ­£å¸¸ |
| GeneralUpdate.Zip          | 1.0.0         | 1.3.0         | æ­£å¸¸ |
| GeneralUpdate.Tool         | 1.0.0         | 2.1.5         | æ­£å¸¸ |
| GeneralUpdate.Single       | 1.0.0         | -             | æ­£å¸¸ |



ã€1ã€‘ç»„ä»¶GeneralUpdate.AspNetCore

ï¼ˆ1ï¼‰é‡æ„ï¼šå°†ä¹‹å‰çš„versionå’Œvalidateæ–¹æ³•åˆå¹¶ä¸ºUpdateæ–¹æ³•ï¼Œå°†è¿™ä¸€ä¸ªæ–¹æ³•å®Œæˆç‰ˆæœ¬éªŒè¯å’Œè¿”å›æ›´æ–°ä¿¡æ¯åŠŸèƒ½ã€‚

ï¼ˆ2ï¼‰æ–°å¢ï¼šä¸ºé…åˆGeneralUpdate.PacktToolè‡ªåŠ¨ä¸Šä¼ å‘å¸ƒåŠŸèƒ½ï¼Œæ–°å¢äº†uploadæ–¹æ³•ã€‚å®Œæˆç‰ˆæœ¬ä¿¡æ¯å…¥åº“å’Œæ›´æ–°åŒ…è½æ–‡ä»¶æœåŠ¡å™¨ã€‚

GeneralUpdate.AspNetCoreç»„ä»¶æ·»åŠ æ–‡ä»¶ä¸Šä¼ æ¥å£ Â· Issue #I55NFC Â· Juster.zhu/GeneralUpdate - Gitee.com

ï¼ˆ3ï¼‰æ–°å¢ï¼šè¯¥æ–¹æ³•æ˜¯ä¸ºäº†é…åˆå®¢æˆ·ç«¯å³ä½¿æ¨é€é‡è¦ç‰ˆæœ¬æˆ–æœåŠ¡ç«¯æœåŠ¡ä¹‹é—´çš„æ›´æ–°ï¼Œæ–°å¢çš„pushè°ƒç”¨ä¸€æ¬¡ä¹‹åä¼šé€šè¿‡Signal Ræ¨é€æ›´æ–°ä¿¡æ¯ã€‚



ã€2ã€‘ç»„ä»¶GeneralUpdate.ClientCore

ï¼ˆ1ï¼‰ä¿®å¤ï¼šAutoUpdate.Coreä¸AutoUpdate.ClientCoreæ–‡ä»¶å†²çªé—®é¢˜ Â· Issue #I5F2YM Â· Juster.zhu/GeneralUpdate - Gitee.com

ï¼ˆ2ï¼‰ä¿®å¤ï¼šæ›´æ–°ç»„ä»¶æ— éœ€æ›´æ–°æŠ¥é”™ Â· Issue #I5F1VN Â· Juster.zhu/GeneralUpdate - Gitee.com

ï¼ˆ3ï¼‰é‡æ„ï¼šæ›´æ–°æœºåˆ¶éœ€é€‚é…å¤šä¸ªæ“ä½œç³»ç»Ÿå¹³å° Â· Issue #I5LYQZ Â· Juster.zhu/GeneralUpdate - Gitee.com

ï¼ˆ4ï¼‰é‡æ„ï¼šé‡æ„ç‰ˆæœ¬éªŒè¯æœºåˆ¶ Â· Issue #I5LYQY Â· Juster.zhu/GeneralUpdate - Gitee.com

ï¼ˆ5ï¼‰æ–°å¢ï¼šé…ç½®é€‚åº”MAUI - Windows machice Â· Issue #I4TGJC Â· Juster.zhu/GeneralUpdate - Gitee.com

ï¼ˆ6ï¼‰ä¿®å¤ï¼šå½“ä¸»ç¨‹åºå·²ç»æ˜¯æœ€æ–°æ—¶ï¼Œæ˜¯ä¸æ˜¯åº”è¯¥å…ˆåˆ¤æ–­ï¼Œè¿™æ—¶å€™å°±ä¸ç”¨å¯åŠ¨å‡çº§è½¯ä»¶å§ï¼Ÿ Â· Issue #I5O53P Â· Juster.zhu/GeneralUpdate - Gitee.com

ï¼ˆ7ï¼‰é‡æ„ï¼š

å°†

```
public GeneralClientBootstrap Config(ClientParmeter info)
```

ä¿®æ”¹ä¸ºï¼š

```
public GeneralClientBootstrap Config(Configinfo info)
```

åªæ˜¯æ”¹å˜äº†ç±»åç§°ï¼Œå­—æ®µå†…å®¹åˆ é™¤validaterulå’Œversionurlã€‚

ï¼ˆ8ï¼‰æ–°å¢ï¼š

ç”¨æˆ·è‡ªå®šä¹‰æ–¹æ³•ï¼Œå†³å®šæ˜¯å¦è·³è¿‡æœ¬æ¬¡æ›´æ–°çš„Taskç‰ˆæœ¬æ–¹æ³•ã€‚

```c#
public GeneralClientBootstrap SetCustomOption(Func<Task<bool>> func)
```

ï¼ˆ9ï¼‰æ–°å¢ï¼š

åœ¨æ›´æ–°é…ç½®ä¸­æ–°å¢äº†æšä¸¾ï¼Œå°†åŸæ¥çš„å­—ç¬¦ä¸²â€œ.zipâ€ä¿®æ”¹ä¸ºæšä¸¾Format.ZIPï¼Œé˜²æ­¢ç”¨æˆ·è¾“å…¥å­—ç¬¦ä¸²é”™è¯¯ã€‚

```c#
Option(UpdateOption.Format, Format.ZIP)
```



ã€3ã€‘ç»„ä»¶GeneralUpdate.Core

ï¼ˆ1ï¼‰é‡æ„ï¼šæ›´æ–°æœºåˆ¶éœ€é€‚é…å¤šä¸ªæ“ä½œç³»ç»Ÿå¹³å° Â· Issue #I5LYQZ Â· Juster.zhu/GeneralUpdate - Gitee.com

ï¼ˆ2ï¼‰é‡æ„ï¼šé‡æ„ç‰ˆæœ¬éªŒè¯æœºåˆ¶ Â· Issue #I5LYQY Â· Juster.zhu/GeneralUpdate - Gitee.com

ï¼ˆ3ï¼‰ä¿®å¤ï¼šå½“ä¸»ç¨‹åºå·²ç»æ˜¯æœ€æ–°æ—¶ï¼Œæ˜¯ä¸æ˜¯åº”è¯¥å…ˆåˆ¤æ–­ï¼Œè¿™æ—¶å€™å°±ä¸ç”¨å¯åŠ¨å‡çº§è½¯ä»¶å§ï¼Ÿ Â· Issue #I5O53P Â· Juster.zhu/GeneralUpdate - Gitee.com

ï¼ˆ4ï¼‰ä¿®å¤ï¼šBUG: "GeneralUpdate.Core\Utils\FileUtil.cs" GetFileMD5 å‡½æ•°å¼‚å¸¸ Â· Issue #I5J0KA Â· Juster.zhu/GeneralUpdate - Gitee.com

ï¼ˆ5ï¼‰ä¿®å¤ï¼šå¤šçº§æ–‡ä»¶å¤¹ç»“æ„æ›´æ–°å¤±è´¥é—®é¢˜ Â· Issue #I59QRI Â· Juster.zhu/GeneralUpdate - Gitee.com

ï¼ˆ6ï¼‰æ–°å¢ï¼šåœ¨æ›´æ–°ä½“ç³»ä¸­æ·»åŠ å®¢æˆ·ç«¯å”¯ä¸€æ ‡è¯† Â· Issue #I55NFP Â· Juster.zhu/GeneralUpdate - Gitee.com

ï¼ˆ7ï¼‰ä¸‹çº¿ï¼šjsoné…ç½®æ–‡ä»¶æ›´æ–°åŠŸèƒ½ï¼Œå°†ç›´æ¥è¦†ç›–ã€‚ç­‰å¾…é‡æ„å®Œæˆå†æ¬¡ä¸Šçº¿ã€‚å½±å“èŒƒå›´å¦‚ä¸‹ï¼š

è€å“¥ï¼Œä¸€ç‚¹ç‚¹å»ºè®® Â· Issue #I556BK Â· Juster.zhu/GeneralUpdate - Gitee.com

æŠ¥é”™ Â· Issue #I53XYX Â· Juster.zhu/GeneralUpdate - Gitee.com

ï¼ˆ8ï¼‰è°ƒç ”ï¼šå¯è¡Œã€‚

è°ƒç ”Macç¯å¢ƒä¸‹æ˜¯å¦å¯ä»¥æ­£å¸¸è¿è¡Œ Â· Issue #I4TGKK Â· Juster.zhu/GeneralUpdate - Gitee.com

ï¼ˆ9ï¼‰ä¿®å¤ï¼šbugï¼š"GeneralUpdate\src\GeneralUpdate.Core\Download\AbstractTask.cs" ç¬¬143è¡Œ Â· Issue #I4WQQ0 Â· Juster.zhu/GeneralUpdate - Gitee.com



ã€4ã€‘ç»„ä»¶GeneralUpdate.Differential

é‡æ„ï¼šé€’å½’æŸ¥æ‰¾éœ€æ›´æ–°æ–‡ä»¶ï¼Œé˜²æ­¢ä¸€äº›æ–‡ä»¶æ²¡æœ‰æ›´æ–°æ£€æµ‹åˆ°ã€‚æ·»åŠ æ ‘å½¢ç»“æ„ç®¡ç†æ›´æ–°æ–‡ä»¶ç›®å½•ç»“æ„ã€‚

ä¿®å¤ï¼šåªèƒ½æ›´æ–°ç¬¬ä¸€å±‚æ–‡ä»¶bugï¼Œç°åœ¨å¯ä»¥é€’å½’æ›´æ–°æ‰€æœ‰ç›®å½•ä¸‹çš„æ–‡ä»¶å¤¹å’Œå­æ–‡ä»¶å¤¹å†…çš„æ–‡ä»¶åˆ—è¡¨ã€‚

ä¿®å¤ï¼šæ‰“åŒ…å·¥å…·æ‰“åŒ…æ–‡ä»¶åŒ…å«ä¸¤ä¸ªåç§°ç›¸åŒä½†åç¼€ä¸åŒçš„æ–‡ä»¶æ—¶ä¼šå‡ºé”™ Â· Issue #I5O4OD Â· Juster.zhu/GeneralUpdate - Gitee.com



ã€5ã€‘ç»„ä»¶GeneralUpdate.Zip

ï¼ˆ1ï¼‰ä¿®å¤ï¼šå…³äºæ–‡ä»¶å‹ç¼©çš„å‡ ä¸ªé—®é¢˜ Â· Issue #I5J4Y6 Â· Juster.zhu/GeneralUpdate - Gitee.com

ï¼ˆ2ï¼‰ä¿®å¤ï¼šwordæ–‡ä»¶ä¹±ç  Â· Issue #I5O4S6 Â· Juster.zhu/GeneralUpdate - Gitee.com

ï¼ˆ3ï¼‰ä¿®å¤ï¼šä¸‹è½½åŒ…è§£å‹åœ¨Cç›˜ä¸‹Program Files (x86)æ—¶ï¼Œæ²¡æœ‰æƒé™æ“ä½œæ€ä¹ˆå¤„ç†ï¼Ÿ Â· Issue #I4ZKQ4 Â· Juster.zhu/GeneralUpdate - Gitee.com



ã€6ã€‘GeneralUpdate.PacketTool

ï¼ˆ1ï¼‰ä¿®å¤ï¼šæ‰“åŒ…å·¥å…·æ‰“åŒ…æ—¶ï¼Œæ²¡æœ‰è€ƒè™‘æœ‰å­æ–‡ä»¶å¤¹çš„é—®é¢˜ Â· Issue #I5O4P8 Â· Juster.zhu/GeneralUpdate - Gitee.com

ï¼ˆ2ï¼‰é‡æ„ï¼šé‡æ„æ–‡ä»¶åŠŸèƒ½ä½“ç³» Â· Issue #I59Q5W Â· Juster.zhu/GeneralUpdate - Gitee.com

ï¼ˆ3ï¼‰é‡æ„ï¼šæ‰“åŒ…å·¥å…·è¿ç§»åˆ°MAUI Â· Issue #I5QOLG Â· Juster.zhu/GeneralUpdate - Gitee.com

ï¼ˆ4ï¼‰æ–°å¢ï¼šGeneralUpdate.Toolæ·»åŠ ä¸Šä¼ åŠŸèƒ½ Â· Issue #I55NF1 Â· Juster.zhu/GeneralUpdate - Gitee.com

ï¼ˆ5ï¼‰ä¿®å¤ï¼šå½“åªä¿®æ”¹æ–‡ä»¶å†…å®¹æ—¶ï¼ŒPacketToolæ‰“åŒ…åŠŸèƒ½æ— æ•ˆ Â· Issue #I5BERJ Â· Juster.zhu/GeneralUpdate - Gitee.com

ï¼ˆ6ï¼‰ä¿®å¤ï¼šæ–‡ä»¶è§£å‹åä¸­æ–‡åæ˜¾ç¤ºä¹±ç  Â· Issue #I502QQ Â· Juster.zhu/GeneralUpdate - Gitee.com



ã€7ã€‘æµ‹è¯•ç”¨ä¾‹ ã€ç¤ºä¾‹ä»£ç 

ç¤ºä¾‹ä»£ç ï¼š

src/c#/GeneralUpdate.Api/Program.cs Â· Juster.zhu/GeneralUpdate - Gitee.com

src/c#/GeneralUpdate.Client/MainPage.xaml.cs Â· Juster.zhu/GeneralUpdate - Gitee.com

src/c#/GeneralUpdate.Upgrad/Program.cs Â· Juster.zhu/GeneralUpdate - Gitee.com

æµ‹è¯•ç”¨ä¾‹ï¼ˆè¿˜åœ¨å®Œå–„ï¼‰ï¼š

src/c#/TestClientCore/UnitTest1.cs Â· Juster.zhu/GeneralUpdate - Gitee.com

src/c#/TestDifferential/UnitTest1.cs Â· Juster.zhu/GeneralUpdate - Gitee.com

src/c#/TestMD5/UnitTest1.cs Â· Juster.zhu/GeneralUpdate - Gitee.com

src/c#/TestService/Program.cs Â· Juster.zhu/GeneralUpdate - Gitee.com

src/c#/TestZIP/UnitTest1.cs Â· Juster.zhu/GeneralUpdate - Gitee.com



## ğŸ“2022-04-03

ï¼ˆ1ï¼‰ä¸»ç¨‹åºå’Œå‡çº§ç¨‹åºä¹‹é—´æ˜¯å¦æ”¯æŒç›¸äº’å‡çº§ï¼Ÿ

ç­”ï¼šæ”¯æŒã€‚

ï¼ˆ2ï¼‰æ˜¯å¦éœ€è¦å¼€å‘è€…å†™ä»£ç å…³é—­è¿›ç¨‹çš„æ—¶æœºæˆ–è€…å…¶ä»–ä»£ç ï¼Ÿ

ç­”ï¼šä¸éœ€è¦ï¼Œç»„ä»¶å·²ç»å°†æ•´ä¸ªæ›´æ–°æµç¨‹è€ƒè™‘åˆ°äº†ã€‚æ‰€ä»¥é™¤äº†ç»„ä»¶ä»£ç ä»¥å¤–ï¼Œä¸éœ€è¦å¼€å‘è€…é¢å¤–å¤šå†™ä»»ä½•è¾…åŠ©ä»£ç ã€‚

ï¼ˆ3ï¼‰æ›´æ–°ç¨‹åºæ˜¯å¦éœ€è¦å’Œä¸»ç¨‹åºæ”¾åœ¨åŒä¸€ä¸ªç›®å½•ä¸‹ï¼Ÿ

ç­”ï¼šæ˜¯çš„ï¼Œéœ€è¦ã€‚ä½†ä¸€å®šè¦ä¿æŒå‡çº§ç¨‹åºä¸èƒ½å¼•ç”¨ä¸»ç¨‹åºçš„é‡Œçš„ä»»ä½•ä»£ç ã€‚å¦åˆ™ä¼šæ›´æ–°å¤±è´¥ã€‚

ï¼ˆ4ï¼‰æ›´æ–°å®Œæˆä¹‹åä¼šåˆ é™¤æ›´æ–°åŒ…çš„è¡¥ä¸æ–‡ä»¶å—ï¼Ÿ

ç­”ï¼šä¼šçš„ï¼Œç»„ä»¶æ›´æ–°å®Œæˆä¹‹åä¼šä¿è¯æ–‡ä»¶åˆ—è¡¨å¹²å‡€ï¼Œä¸ä¼šå‡ºç°å†—ä½™æ–‡ä»¶æ±¡æŸ“ã€ç£ç›˜ç©ºé—´å ç”¨çš„æƒ…å†µã€‚

ï¼ˆ5ï¼‰å¯ä»¥è¿ç”¨åœ¨æœåŠ¡ç«¯å—ï¼Ÿå°±æ˜¯æœåŠ¡ä¸æœåŠ¡ä¹‹é—´çš„å‡çº§ã€‚

ç­”ï¼šç†è®ºä¸Šæ”¯æŒçš„ï¼Œä½œè€…æ²¡æœ‰å®é™…è¿™ä¹ˆä½¿ç”¨è¿‡ã€‚æ®åé¦ˆæœ‰çš„å°ä¼™ä¼´å·²ç»è¿™ä¹ˆå¹²äº†ã€‚æœ¬æ¬¡åˆ†äº«æ˜¯é’ˆå¯¹C/Sæ¶æ„çš„åœºæ™¯ã€‚

ï¼ˆ6ï¼‰æ€ä¹ˆè·å–æ›´æ–°åŒ…çš„MD5ç ï¼Ÿ

ç­”ï¼šä½¿ç”¨é¡¹ç›®æºç é‡Œçš„ï¼ŒAutoUpdate.MD5å·¥ç¨‹ã€‚

ï¼ˆ7ï¼‰æ€ä¹ˆåˆ¶ä½œä¸€ä¸ªæ›´æ–°åŒ…ï¼Ÿ

ç­”ï¼šä½¿ç”¨GeneralUpdate.PacketToolå·¥å…·ç”Ÿæˆå³å¯ã€‚åœ¨æºç ä»“åº“çš„releaseä¸­å¯ä»¥çœ‹åˆ°æ‰“åŒ…å¥½çš„å®‰è£…ç¨‹åºã€‚

ï¼ˆ8ï¼‰å…³äºç»„ä»¶çš„å…¶ä»–å†…å®¹å¦‚ä½•äº†è§£åˆ°ï¼Ÿ

ç­”ï¼šå¯ä»¥é€šè¿‡å®˜æ–¹ç½‘ç«™ã€æˆ–è€…ç›¸å…³Qç¾¤ã€ä»¥åŠæˆ‘giteeæˆ–githubçš„issueä¸­ä¸æˆ‘äº¤æµã€‚

ï¼ˆ9ï¼‰ä¸‹è½½åŒ…è§£å‹åœ¨Cç›˜ä¸‹Program Files (x86)æ—¶ï¼Œæ²¡æœ‰æƒé™æ“ä½œæ€ä¹ˆå¤„ç†ï¼Ÿ

ç­”ï¼šhttps://gitee.com/Juster-zhu/GeneralUpdate/issues/I4ZKQ4

ï¼ˆ10ï¼‰æ›´æ–°æ–‡ä»¶è¾ƒå°æ—¶ï¼Œä¸‹è½½é€Ÿåº¦æ˜¾ç¤ºä¸ºï¼š0B/S ã€‚

ç­”ï¼šhttps://gitee.com/Juster-zhu/GeneralUpdate/issues/I3POMG





## ğŸ“2022-03-23

è¯´æ˜

- åœ¨çº¿å¸®åŠ©æ–‡æ¡£ï¼šhttp://justerzhu.cn/  ï¼ˆåç»­å°†ä¼šæŒ‰ç»„ä»¶æ‹†åˆ†æˆå¯¹åº”çš„æ–‡æ¡£ï¼‰
- Nugetç‰ˆæœ¬ç®¡ç†å‚è€ƒæ ‡å‡†ï¼šhttps://docs.microsoft.com/zh-cn/nuget/concepts/package-versioning
- åº”ç”¨ç¨‹åºé›†ç‰ˆæœ¬ç®¡ç†å‚è€ƒæ ‡å‡†ï¼šhttps://docs.microsoft.com/zh-cn/dotnet/standard/assembly/versioning ï¼ˆè¢«ç»„ä»¶æ›´æ–°çš„å®¢æˆ·ç«¯ç¨‹åºï¼Œè¯´é€šä¿—ç‚¹å°±æ˜¯ä½ å…¬å¸çš„äº§å“ï¼›ç»„ä»¶çš„æ“ä½œå°†æŒ‰ç…§è¿™ä¸ªæ ‡å‡†æ‰§è¡Œã€‚ï¼‰
- æœ¬æ¬¡ç‰ˆæœ¬å‘å¸ƒä¼šæœ‰å¾ˆå¤šæ”¹å˜ï¼Œä¸æ˜¯å¹³æ»‘å‡çº§ï¼ˆè¿½æ±‚ç¨³å®šæˆ–ä¸æƒ³æ”¹åŠ¨æ…ç”¨ï¼‰ã€‚æœ¬é¡¹ç›®æ­£åœ¨é€æ¸ç¨³å®šåç»­å°†ä¼šå¹³æ»‘å‡çº§é¿å…å¼€å‘è€…å†åº¦ä¿®æ”¹ã€‚
- å¦‚æœå‘ç”Ÿâ€œä¹Œé¾™äº‹ä»¶â€ ä¾‹å¦‚ï¼šå‘å¸ƒæ›´æ–°åŒ…å†…å®¹è‡ªèº«é”™è¯¯æˆ–æ›´æ–°è¿‡ç¨‹ä¸­å‘ç”Ÿæ„å¤–ï¼Œä¸å¯å›æ»šã€‚ç›®å‰è§£å†³æ–¹æ¡ˆï¼ˆ1ï¼‰é‡æ–°è¯·æ±‚æ›´æ–°ï¼Œï¼ˆ2ï¼‰é€šè¿‡æ¨é€æœºåˆ¶å‘é€ç´§æ€¥ä¿®å¤ç‰ˆæœ¬æ›´æ–°åŒ…ï¼›æ¥è§£å†³æ­¤ç±»é—®é¢˜ã€‚
- å…³äºâ€œä¸å¯å›æ»šâ€è¿™ä¸ªé—®é¢˜ï¼Œå¦‚æœæœ‰æ›´å¥½çš„åŠæ³•å¸Œæœ›å„ä½å¯ä»¥ç›´æ¥åœ¨issuesä¸­æå‡ºæ‚¨çš„çœ‹æ³•ï¼›ç›®å‰ç¤¾åŒºä¸­æœ‰ä¸¤ç§å£°éŸ³ï¼ˆ1ï¼‰å‡ºç°æ„å¤–æƒ…å†µå¸Œæœ›ç»„ä»¶å¯ä»¥å°†æœ¬åœ°ç¨‹åºå›æ»šè‡³åŸæ¥çš„ç‰ˆæœ¬ï¼Œä¿è¯å“ªæ€•æ›´æ–°å¤±è´¥ä¹Ÿè¦ç”¨æˆ·å¯ç”¨ã€‚ï¼ˆ2ï¼‰æ›´æ–°ç»„ä»¶çš„æ„ä¹‰å°±æ˜¯å°†ç»„ä»¶æ¨å‘æ–°çš„ç‰ˆæœ¬è®©æœ¬æ¬¡çš„ç‰ˆæœ¬å‘å¸ƒæœ‰æ•ˆï¼Œå¦‚æœæ›´æ–°å¤±è´¥é‚£ä¹ˆè®©å®ƒæ›´æ–°æˆåŠŸä¸ºæ­¢ï¼›åªè®¸å‰è¿›ä¸è®¸é€€



å‘å¸ƒå†…å®¹

è¿™é‡Œå…ˆçœ‹çœ‹å‘å¸ƒçš„ç‰ˆæœ¬å·ä»¥åŠè¿™æ¬¡å¤§ç‰ˆæœ¬çš„æ›´æ–°å‘ç”Ÿäº†å“ªäº›æ”¹åŠ¨ï¼ˆå…±8ä¸ªéƒ¨åˆ†ï¼‰ã€‚

| ç»„ä»¶åç§°                   | ç‰ˆæœ¬å·ï¼ˆoldï¼‰ | ç‰ˆæœ¬å·ï¼ˆnewï¼‰ | çŠ¶æ€ |
| -------------------------- | ------------- | ------------- | ---- |
| GeneralUpdate.AspNetCore   | 1.0.0         | 1.1.0         | æ­£å¸¸ |
| GeneralUpdate.ClientCore   | 1.1.2         | 2.3.6         | æ­£å¸¸ |
| GeneralUpdate.Core         | 3.6.10        | 4.10.12       | æ­£å¸¸ |
| GeneralUpdate.Differential | -             | 1.0.0         | æ­£å¸¸ |
| GeneralUpdate.Common       | 1.0.0         | -             | ç§»é™¤ |



ã€1ã€‘ç»„ä»¶GeneralUpdate.AspNetCore

ï¼ˆ1ï¼‰[NEW] æ·»åŠ äº†æœ€æ–°ç‰ˆæœ¬æ¨é€åŠŸèƒ½ï¼ŒVersionHubå¯¹è±¡ã€‚ä¸»è¦è§£å†³ä¸´æ—¶éœ€è¦æ¨é€ç´§æ€¥ä¿®å¤é‡å¤§bugçš„ç‰ˆæœ¬ã€‚

```c#
var builder = WebApplication.CreateBuilder(args);
builder.Services.AddSingleton<IUpdateService, GeneralUpdateService>();
builder.Services.AddSignalR();
var app = builder.Build();

app.MapHub<VersionHub>("/versionhub");

app.Use(async (context, next) =>
{
   var hubContext = context.RequestServices.GetRequiredService<IHubContext<VersionHub>>();
   await CommonHubContextMethod((IHubContext)hubContext);
   if (next != null)
  {
       await next.Invoke();
  }
});

async Task CommonHubContextMethod(IHubContext context)
{
   await context.Clients.All.SendAsync("clientMethod", "");
}
```



ã€2ã€‘ç»„ä»¶GeneralUpdate.ClientCore

ï¼ˆ1ï¼‰[NEW] åœ¨GeneralClientBootstrapä¸­é‡è½½äº†é…ç½®æ–¹å¼ï¼Œè¯¥æ–¹æ³•ç®€åŒ–ä¸ºåªéœ€è¦ä¼ é€’è¿œç¨‹æœåŠ¡å™¨åœ°å€ä¾‹å¦‚http://127.0.0.1 å’Œæ›´æ–°ç¨‹åºåç§°å³å¯ï¼Œç®€åŒ–äº†å¼€å‘è€…éœ€è¦å…³å¿ƒçš„å‚æ•°ç»„ä»¶å†…è‡ªåŠ¨è·å–ã€‚

```c#
public GeneralClientBootstrap Config(string url, string appName = "AutoUpdate.Core");
```

ï¼ˆ2ï¼‰[NEW] æ·»åŠ äº†æœ€æ–°ç‰ˆæœ¬æ¥æ”¶æ¨é€åŠŸèƒ½ï¼ŒVersionHubå¯¹è±¡ã€‚ä¸»è¦è§£å†³ä¸´æ—¶éœ€è¦æ¥æ”¶ç´§æ€¥ä¿®å¤é‡å¤§bugçš„ç‰ˆæœ¬ï¼Œå¯ä»¥åœ¨GetMessageå›è°ƒå‡½æ•°ä¸­å¯æ·»åŠ æ›´æ–°æ“ä½œã€‚

```c#
VersionHub<string>.Instance.Subscribe($"{ baseUrl }/{ hubName }", "TESTNAME", new Action<string>(GetMessage));
```



ã€3ã€‘ç»„ä»¶GeneralUpdate.Core

ï¼ˆ1ï¼‰[FIX] ä¿®å¤ä¸‹è½½ä¸­é€”æ–­ç½‘ï¼Œåˆ°è¾¾è¶…æ—¶æ—¶é—´æ²¡æœ‰å¼‚å¸¸ä¸ŠæŠ›é—®é¢˜ã€‚

ï¼ˆ2ï¼‰[REFACTOR] é‡æ„å¤šä»»åŠ¡ä¸‹è½½è®¾è®¡ã€‚

ï¼ˆ3ï¼‰[FIX] ä¿®å¤FileUtil.Update32Or64Libsåœ¨æŸäº›æƒ…å†µä¸‹ä¼šæŠ›å‡ºå¼‚å¸¸ã€‚

ï¼ˆ4ï¼‰[REFACTOR] é‡æ„é»˜è®¤æ›´æ–°ç­–ç•¥è®¾è®¡ã€‚

ï¼ˆ5ï¼‰[NEW] æ·»åŠ äº†æœ€æ–°ç‰ˆæœ¬æ¥æ”¶æ¨é€åŠŸèƒ½ï¼ŒVersionHubå¯¹è±¡ã€‚ä¸»è¦è§£å†³ä¸´æ—¶éœ€è¦æ¥æ”¶ç´§æ€¥ä¿®å¤é‡å¤§bugçš„ç‰ˆæœ¬ã€‚å¼€å‘è€…å¯ä»¥åœ¨GetMessageå›è°ƒå‡½æ•°ä¸­å¯æ·»åŠ æ›´æ–°æ“ä½œã€‚

```c#
VersionHub<string>.Instance.Subscribe($"{ baseUrl }/{ hubName }", "TESTNAME", new Action<string>(GetMessage));
```

ï¼ˆ6ï¼‰[NEW] æ”¯æŒ7zå‹ç¼©åŒ…çš„è§£å‹åŠŸèƒ½ã€‚

ï¼ˆ7ï¼‰[REMOVE] ç§»é™¤äº†GeneralUpdate.Coreä¸GeneralUpdate.ClientCore ä¸­é‡å¤ä»£ç ï¼Œé€šç”¨ä»£ç é€šè¿‡é“¾æ¥æ–‡ä»¶è§£å†³å†—ä½™é—®é¢˜ã€‚

ï¼ˆ8ï¼‰[NEW] æ”¯æŒå¢é‡æ›´æ–°åŠŸèƒ½ï¼Œä¾‹å¦‚ï¼šåªæ›´æ–°äº†ä¸€ä¸ªæ–‡ä»¶ï¼Œé‚£ä¹ˆå°±åªå°†è¯¥æ–‡ä»¶æ‰“åŒ…ã€‚

ï¼ˆ9ï¼‰[NEW] æ”¯æŒäºŒè¿›åˆ¶å·®åˆ†åŠŸèƒ½ï¼Œä¾‹å¦‚ï¼štemp.dll å‘ç”Ÿäº†ä¿®æ”¹äº§ç”Ÿäº†æ–°ç‰ˆæœ¬çš„æ–‡ä»¶ï¼Œé‚£ä¹ˆå°†ä¼šæŠŠtemp.dllçš„æ–°ç‰ˆæœ¬æ–‡ä»¶å’Œè€ç‰ˆæœ¬æ–‡ä»¶åšä¸€ä¸ªå·®åˆ†ã€‚æœ€åç”Ÿæˆä¸€ä¸ª.patchçš„è¡¥ä¸æ–‡ä»¶ï¼ŒæŒ‰ç…§æ­£å¸¸é¡¹ç›®è¿­ä»£é‚£ä¹ˆè¿™ä¸ª.patchçš„è¡¥ä¸å°†ä¼šæ˜¯kbçº§çš„ã€‚å†é…åˆ7zçš„é«˜å‹ç¼©å°†æ›´æ–°åŒ…çš„å¤§å°åšåˆ°ç›®å‰çŠ¶æ€ä¸‹çš„æè‡´èŠ‚çœæµé‡å’Œå¸¦å®½å ç”¨ã€‚ç‰¹åˆ«éœ€è¦è¯´æ˜çš„æ˜¯ï¼Œå¦‚æœåœ¨æ–°ç‰ˆæœ¬ä¸­æ·»åŠ äº†æ–°æ–‡ä»¶è¿˜æ˜¯ä¼šå°†æ–°å¢æ–‡ä»¶åŸå°ä¸åŠ¨çš„æ‰“åŒ…åˆ°æ›´æ–°åŒ…ä¸­ã€‚



ã€4ã€‘ç»„ä»¶[NEW]GeneralUpdate.Differential

åœ¨GeneralUpdateä¸­æ–°å¢ç»„ä»¶Differentialï¼Œè¯¥ç»„ä»¶ä¸»è¦æä¾›ä»¥ä¸‹åŠŸèƒ½ï¼š

ï¼ˆ1ï¼‰[NEW] æ–°å¢äºŒè¿›åˆ¶å·®åˆ†æ›´æ–°,ç”Ÿæˆ.patchè¡¥ä¸æ–‡ä»¶ã€‚

ï¼ˆ2ï¼‰[NEW] æ–°å¢å¢é‡æ›´æ–°ï¼Œä¾‹å¦‚ï¼šversion 1.1.1.1åŸæœ‰10ä¸ªæ–‡ä»¶è¿™æ¬¡ç‰ˆæœ¬å‘å¸ƒä¿®æ”¹äº†å…¶ä¸­3ä¸ªæ–‡ä»¶é‚£ä¹ˆåªä¼šå°†ä¿®æ”¹çš„æ–‡ä»¶è¿›è¡Œæ‰“åŒ…ã€‚

ï¼ˆ3ï¼‰[NEW] æ›´æ–°é…ç½®æ–‡ä»¶ï¼ˆç›®å‰åªæ”¯æŒ.jsoné…ç½®æ–‡ä»¶ä¸”å†…å®¹æ·±åº¦ä¸º1çº§ï¼‰ï¼Œä¾‹å¦‚ï¼šå®¢æˆ·ç«¯ç¨‹åºä½¿ç”¨.jsonæ ¼å¼æ–‡ä»¶ä½œä¸ºé…ç½®æ–‡ä»¶ï¼Œé‚£ä¹ˆå°†ä¼šä¿ç•™å®¢æˆ·ç«¯åŸæœ‰é…ç½®å†…å®¹çš„å‰æä¸‹æ›´æ–°é…ç½®æ–‡ä»¶å†…å®¹ã€‚å‡è®¾å®¢æˆ·ç«¯åŸæœ‰é…ç½®æ–‡ä»¶ï¼ˆ.jsonï¼‰ä¸­åŒ…å«å†…å®¹ï¼š

```json
{
  "ip":"123456789",
  "port":9999
}
```

æœåŠ¡ç«¯æ–°çš„é…ç½®æ–‡ä»¶ç»“æ„ä¸ºï¼š

```json
{
  "ip":"0",
  "port":0,
  "path":"c://"
}
```

é‚£ä¹ˆå°†ä¼šæŠŠï¼Œâ€œpathâ€å­—æ®µæ›´æ–°åˆ°å®¢æˆ·ç«¯æœ¬åœ°é…ç½®æ–‡ä»¶ä¸­å¹¶ä¿ç•™åŸæœ‰å†…å®¹ä¸ºï¼š

```json
{
  "ip":"123456789",
  "port":9999,
  "path":"c://"
}
```



ã€5ã€‘ç»„ä»¶GeneralUpdate.Zip

ï¼ˆ1ï¼‰[REFACTOR] é‡æ„å‹ç¼©ç»„ä»¶è®¾è®¡ï¼Œå°†æ”¯æŒ.zipå’Œ.7zå‹ç¼©åŒ…æ ¼å¼ã€‚

ï¼ˆ2ï¼‰[NEW] æ·»åŠ 7zè§£å‹åŠŸèƒ½ã€‚



ã€6ã€‘ç»„ä»¶[REMOVE]GeneralUpdate.Common

ï¼ˆ1ï¼‰ç§»é™¤è¯¥ç»„ä»¶ï¼Œè§£é™¤GeneralUpdate.Coreä¸GeneralUpdate.ClientCore è€¦åˆï¼Œå‘ç°ç›®å‰ç‰ˆæœ¬å¹¶ä¸éœ€è¦ã€‚



ã€7ã€‘ç»„ä»¶GeneralUpdate.Single

æœ¬æ¬¡æœªæ›´æ–°å®é™…åŠŸèƒ½ã€‚



ã€8ã€‘æµ‹è¯•ç”¨ä¾‹ Example

ä¸ºç®€åŒ–å¼€å‘è€…åœ¨éªŒè¯ã€æµ‹è¯•è¿‡ç¨‹ä¸­ç¼–å†™ç”¨ä¾‹å¼€å‘å·¥ä½œã€‚åœ¨GeneralUpdateè§£å†³æ–¹æ¡ˆä¸­æ·»åŠ äº†ä»¥ä¸‹æµ‹è¯•ç”¨ä¾‹ï¼š

- AutoUpdate.ClientCore
- AutoUpdate.Core
- AutoUpdate.MD5
- AutoUpdate.Differential
- AutoUpdate.ZIP
- AutoUpdate.MinimalService
- AutoUpdate.Test





## ğŸ“2022-02-16

ç›®å‰æ¡†æ¶æ”¯æŒ

ç†è®ºæ”¯æ’‘ï¼šhttps://docs.microsoft.com/zh-cn/dotnet/standard/net-standard

| æ¡†æ¶åç§°                              | æ˜¯å¦æ”¯æŒ         |
| ------------------------------------- | ---------------- |
| .NET Core 2.0                         | æ”¯æŒ             |
| .NET 5 6 7                            | æ”¯æŒ             |
| .NET Framework 4.6.1                  | æ”¯æŒ             |
| Mono 5.4                              | ç†è®ºæ”¯æŒï¼ŒæœªéªŒè¯ |
| Xamarin.iOS                           | ç†è®ºæ”¯æŒï¼ŒæœªéªŒè¯ |
| Xamarin.Mac                           | ç†è®ºæ”¯æŒï¼ŒæœªéªŒè¯ |
| Xamarin.Android                       | ç†è®ºæ”¯æŒï¼ŒæœªéªŒè¯ |
| Universal Windows Platform 10.0.16299 | ç†è®ºæ”¯æŒï¼ŒæœªéªŒè¯ |
| Unity 2018.1                          | ç†è®ºæ”¯æŒï¼ŒæœªéªŒè¯ |

| UIæ¡†æ¶åç§°        | æ˜¯å¦æ”¯æŒ           |
| ----------------- | ------------------ |
| WPF               | æ”¯æŒ               |
| UWP               | æœªéªŒè¯ï¼Œç­‰å¾…åé¦ˆ   |
| MAUI              | æš‚ä¸æ”¯æŒï¼Œæ­£åœ¨å…¼å®¹ |
| Avalonia          | æœªéªŒè¯ï¼Œç­‰å¾…åé¦ˆ   |
| WinUI             | æœªéªŒè¯ï¼Œç­‰å¾…åé¦ˆ   |
| Consoleï¼ˆæ§åˆ¶å°ï¼‰ | æ”¯æŒ               |

| æ“ä½œç³»ç»Ÿåç§° | æ˜¯å¦æ”¯æŒ |
| ------------ | -------- |
| Windows      | æ”¯æŒ     |
| Linux        | æœªéªŒè¯   |
| Mac          | æœªéªŒè¯   |
| iOS          | æš‚ä¸æ”¯æŒ |
| Android      | æš‚ä¸æ”¯æŒ |





## ğŸ“2021-08-14

Notice

- é¢„è®¡ä¼šä½¿ç”¨Blazorå¼€å‘GeneralUpdateå®˜ç½‘ï¼Œä»‹ç»ç»„ä»¶ç»“æ„ã€æ›´æ–°æµç¨‹ã€å¿«é€Ÿå¯åŠ¨ã€å‚æ•°ç­‰å†…å®¹ã€‚

![å›¾ç‰‡](imgs/udpate_flow.jpg)

  1.ä¸»ç¨‹åºå¯åŠ¨æ—¶æ£€æµ‹å‡çº§ç¨‹åºæ˜¯å¦éœ€è¦æ›´æ–°
  2.éœ€è¦æ›´æ–°åˆ™æŠŠå‡çº§ç¨‹åºç‰ˆæœ¬å·ä¸Šä¼ å¹¶é€ç‰ˆæœ¬æ›´æ–°
  3.å‡çº§ç¨‹åºæ›´å®Œæˆåæˆ–ä¸éœ€è¦æ›´æ–°ï¼Œåˆ™è¿›è¡Œåˆ¤æ–­ä¸»ç¨‹åº
  æ˜¯å¦éœ€è¦æ›´æ–°å¦‚æœéœ€è¦æ›´æ–°åˆ™å¯åŠ¨å‡çº§ç¨‹åº
  4.è¯·æ±‚ä¸»ç¨‹åºæ›´æ–°ç‰ˆæœ¬
  5.è¯·æ±‚åˆ°ä¸»ç‰ˆæœ¬å¤šä¸ªæ›´æ–°åŒ…å¹¶é€ç‰ˆæœ¬æ›´æ–°
  6.æ›´æ–°å®Œæˆåå…³é—­å‡çº§ç¨‹åºå¯åŠ¨ä¸»ç¨‹åº

![å›¾ç‰‡](imgs/supporting_relationships.jpg)

- ä»¥ä¸Šæ›´æ–°ã€ä¸‹è½½è¿‡ç¨‹å‡æ”¯æŒæ–­ç‚¹ç»­ä¼ å’Œé€ç‰ˆæœ¬æ›´æ–°ã€‚
- é€ç‰ˆæœ¬ä¸‹è½½åŠŸèƒ½æ˜¯æ ¹æ®ç‰ˆæœ¬å‘å¸ƒæ—¶é—´è¿›è¡Œæ’åºçš„å‘å¸ƒæ—¶é—´è¶Šæ—©çš„ç‰ˆæœ¬è¶Šå…ˆæ›´æ–°ï¼ˆå…·ä½“ä¿¡æ¯è§æºç ä¸­çš„sqlè„šæœ¬å­—æ®µå†…å®¹ï¼‰ã€‚
- é€ç‰ˆæœ¬ä¸‹è½½çš„æ›´æ–°åŒ…æœ€å¤§æµ‹è¯•è¿‡1Gæ›´æ–°å†…å®¹ã€‚



2.Nuget

- (New)https://www.nuget.org/packages/GeneralUpdate.Common/
- (New)https://www.nuget.org/packages/GeneralUpdate.ClientCore/
- (New)https://www.nuget.org/packages/GeneralUpdate.AspNetCore/
- https://www.nuget.org/packages/GeneralUpdate.Zip/
- https://www.nuget.org/packages/GeneralUpdate.Single/
- (Update)https://www.nuget.org/packages/GeneralUpdate.Core/

3.Issues & Git ã€Gitee

æ¬¢è¿åœ¨ä»¥ä¸‹åœ°å€æå‡ºissuesæå‡ºæ—¶å°½å¯èƒ½çš„æè¿°æ¸…æ¥šå¼‚å¸¸å‘ç”Ÿçš„åŸå› æˆ–ç¼ºé™·è¯¦æƒ…ï¼Œcheckå‘¨æœŸä¸ºæ¯å‘¨çš„å‘¨äº”ã€‚

- https://gitee.com/Juster-zhu/GeneralUpdate
- https://github.com/WELL-E/AutoUpdater/tree/autoupdate2
- https://github.com/WELL-E/AutoUpdater/issues
- https://gitee.com/Juster-zhu/GeneralUpdate/issues

4.New

- GeneralUpdate.Coreæ·»åŠ é€ç‰ˆæœ¬æ›´æ–°åŠŸèƒ½
- GeneralUpdate.Coreæ–°å¢äº‹ä»¶ExceptionEventã€MutiDownloadStatisticsEventã€MutiDownloadErrorEventã€MutiDownloadCompletedEventã€MutiDownloadProgressEventã€MutiAllDownloadCompletedEventã€‚
- GeneralUpdate.Coreæ–°å¢RemoteAddressBase64æ–¹æ³•ã€‚
- æ–°å¢ClientParameterç±»ï¼Œç”¨äºç»„ä»¶ä¹‹é—´è¿›ç¨‹é€šè®¯ä¼ é€’å‚æ•°ã€‚
- æ–°å¢ç»„ä»¶GeneralUpdate.AspNetCore,å…·æœ‰æ ¹æ®å‡çº§ç±»å‹è¿”å›æ›´æ–°ç‰ˆæœ¬ä¿¡æ¯çš„åŠŸèƒ½å¹¶æ”¯æŒç®¡é“ä¾èµ–æ³¨å…¥ä½¿ç”¨ï¼Œä½†éœ€è¦è‡ªå·±ç¼–å†™æŸ¥åº“çš„æ–¹æ³•ã€‚
- æ–°å¢ç»„ä»¶GeneralUpdate.ClientCore,
  - (1)å…·æœ‰æ›´æ–°å‡çº§ç»„ä»¶ç‰ˆæœ¬åŠŸèƒ½ï¼ˆæ›´æ–°ç¨‹åºæ›´æ–°è‡ªå·±ï¼‰
  - (2)æ”¯æŒå‡çº§ç»„ä»¶çš„é€ç‰ˆæœ¬æ›´æ–°(å¤šæ›´æ–°åŒ…åŒæ—¶ä¸‹è½½)
  - (3)ä¾¿æ·å¯åŠ¨å‡çº§ç¨‹åºï¼Œæ‘†è„±ä¹‹å‰çš„ç¹çè¿›ç¨‹å¯åŠ¨å’Œä¼ å‚ã€‚
- æ–°å¢ç»„ä»¶GeneralUpdate.Common è¯¥åº“æ•´åˆäº†ç»„ä»¶å†…ä½¿ç”¨çš„æ‰€æœ‰å…¬å…±ç±»å’Œè¾…åŠ©æ–¹æ³•ï¼ˆè¯¥ç»„ä»¶ä¸ºå¿…é¡»ç»„ä»¶ï¼Œè¯¥ç»„ä»¶æ›´æ–°é¢‘ç‡éå¸¸ä½ä¸æ¨èæ‰“åŒ…åœ¨æ›´æ–°åŒ…ä¸­ï¼‰ã€‚
- æ–°å¢mysqlè„šæœ¬ï¼Œç”¨äºåˆ›å»ºGeneralUpdate.AspNetCoreæœåŠ¡ç«¯ä½¿ç”¨çš„update_versionè¡¨ã€‚

5.Remove

- ç§»é™¤GeneralUpdate.Coreä¸­æ‰€æœ‰çš„é€šçŸ¥äº‹ä»¶æ›¿æ¢ä¸ºMutixxxxEvent.
- ç§»é™¤GeneralUpdate.Coreä¸­GeneralUpdateBootstrapå¯åŠ¨ä¸­é€šè¿‡è¿›ç¨‹ä¼ é€’å‚æ•°çš„æ–¹æ³•RemoteAddressæ–¹æ³•ã€‚
- ç§»é™¤æ›´æ–°å¤±è´¥ç‰ˆæœ¬å›æ»šåŠŸèƒ½ï¼Œè¯¥åŠŸèƒ½å¯¼è‡´åœ¨Cç›˜å›æ»šæ›´æ–°æ—¶å› æƒé™ä¸å¤Ÿå‘ç”Ÿè‡´å‘½å¼‚å¸¸é—®é¢˜ï¼Œè¯¥åŠŸèƒ½è€ƒè™‘åç»­å¼€æ”¾ã€‚

6.Fix

- ä¿®å¤https sslè®¿é—®å¤±è´¥é—®é¢˜ã€‚
- ä¿®å¤å…¶ä»–.netæ¡†æ¶ç‰ˆæœ¬æ³¨å†Œäº‹ä»¶begininvokeé€šçŸ¥å¼‚å¸¸é—®é¢˜ã€‚
- ä¿®æ”¹å¤šå¤„ç±»åå•è¯æ‹¼å†™é”™è¯¯é—®é¢˜ã€‚
- å¯¹è‹¥å¹²Modelç±»åˆ é™¤äº†ä¸å¿…è¦å­—æ®µã€‚

7.Quick Start

**ï¼ˆ1ï¼‰ Example GeneralUpdate.ClientCore**

```
            //Clinet version.
            var mainVersion = "1.1.1";
            var mianType = 1;

            //Updater version
            clientParameter = new ClientParameter();
            clientParameter.ClientVersion = "1.1.1";
            clientParameter.ClientType = 2;
            clientParameter.AppName = "AutoUpdate.ConsoleApp";
            clientParameter.MainAppName = "AutoUpdate.Test";
            clientParameter.InstallPath = @"D:\update_test";
            clientParameter.UpdateLogUrl = "https://www.baidu.com/";
            clientParameter.ValidateUrl = $"https://127.0.0.1:5001/api/update/getUpdateValidate/{ clientParameter.ClientType }/{ clientParameter.ClientVersion }";
            clientParameter.UpdateUrl = $"https://127.0.0.1:5001/api/update/getUpdateVersions/{ clientParameter.ClientType }/{ clientParameter.ClientVersion }";
            clientParameter.MainValidateUrl = $"https://127.0.0.1:5001/api/update/getUpdateValidate/{ mianType }/{ mainVersion }";
            clientParameter.MainUpdateUrl = $"https://127.0.0.1:5001/api/update/getUpdateVersions/{ mianType }/{ mainVersion }";

            generalClientBootstrap = new GeneralClientBootstrap();
            generalClientBootstrap.MutiDownloadProgressChanged += OnMutiDownloadProgressChanged;
            generalClientBootstrap.MutiDownloadStatistics += OnMutiDownloadStatistics;
            generalClientBootstrap.MutiDownloadCompleted += OnMutiDownloadCompleted;
            generalClientBootstrap.MutiAllDownloadCompleted += OnMutiAllDownloadCompleted;
            generalClientBootstrap.MutiDownloadError += OnMutiDownloadError;
            generalClientBootstrap.Exception += OnException;
            generalClientBootstrap.Config(clientParameter).
                Strategy<ClientStrategy>();
            await generalClientBootstrap.LaunchTaskAsync();
```

**ï¼ˆ2ï¼‰ Example GeneralUpdate.Core**

```
    static void Main(string[] args)
    {
        var resultBase64 = args[0];
        var bootstrap = new GeneralUpdateBootstrap();
        bootstrap.Exception += OnException;
        bootstrap.MutiDownloadError += OnMutiDownloadError;
        bootstrap.MutiDownloadCompleted += OnMutiDownloadCompleted;
        bootstrap.MutiDownloadStatistics += OnMutiDownloadStatistics;
        bootstrap.MutiDownloadProgressChanged += OnMutiDownloadProgressChanged;
        bootstrap.MutiAllDownloadCompleted += OnMutiAllDownloadCompleted;
        bootstrap.Strategy<DefaultStrategy>().
            Option(UpdateOption.DownloadTimeOut, 60).
            RemoteAddressBase64(resultBase64).
            LaunchAsync();
    }
```

**ï¼ˆ3ï¼‰ Example GeneralUpdate.AspNetCore**

```c#
    Startup.cs
    public void ConfigureServices(IServiceCollection services)
    {
        services.AddControllers();
        services.AddSingleton<IUpdateService, GeneralUpdateService>();
    }

    UpdateController.cs

    private readonly ILogger<UpdateController> _logger;
    private readonly IUpdateService _updateService;

    public UpdateController(ILogger<UpdateController> logger, IUpdateService updateService)
    {
        _logger = logger;
        _updateService = updateService;
    }

    /// <summary>
    /// https://localhost:5001/api/update/getUpdateVersions/1/1.1.1
    /// </summary>
    /// <param name="clientType"> 1:ClientApp 2:UpdateApp</param>
    /// <param name="clientVersion"></param>
    /// <returns></returns>
    [HttpGet("getUpdateVersions/{clientType}/{clientVersion}")]
    public async Task<IActionResult> GetUpdateVersions(int clientType, string clientVersion)
    {
        _logger.LogInformation("Client request 'GetUpdateVersions'.");
        var resultJson = await _updateService.UpdateVersionsTaskAsync(clientType, clientVersion, UpdateVersions);
        return Ok(resultJson);
    }

    /// <summary>
    /// https://localhost:5001/api/update/getUpdateValidate/1/1.1.1
    /// </summary>
    /// <param name="clientType"> 1:ClientApp 2:UpdateApp</param>
    /// <param name="clientVersion"></param>
    /// <returns></returns>
    [HttpGet("getUpdateValidate/{clientType}/{clientVersion}")]
    public async Task<IActionResult> GetUpdateValidate(int clientType, string clientVersion)
    {
        _logger.LogInformation("Client request 'GetUpdateValidate'.");
        var lastVersion = GetLastVersion();
        var resultJson = await _updateService.UpdateValidateTaskAsync(clientType, clientVersion, lastVersion, true, GetValidateInfos);
        return Ok(resultJson);
    }
```



## ğŸ“2021-03-18

å£°æ˜

1. æœ¬ç»„ä»¶å°†æ”¯æŒä»¥ä¸‹æ¡†æ¶å¼€å‘çš„åº”ç”¨ç¨‹åºã€‚.NET Framework 4.6.1 | .NET Core 2.0 | .NET 5
2. GeneralUpdate.Singleç»„ä»¶ç›®å‰ä»…æ”¯æŒwpfå’Œ.NET Frameworkæ¡†æ¶ã€‚

æ–°å¢

1. GeneralUpdate.Core-3.2.1ç‰ˆæœ¬ï¼Œæ–°å¢æ›´æ–°å¤±è´¥å›æ»šåŠŸèƒ½ã€‚
2. æ–°å¢äº†ç»„ä»¶ GeneralUpdate.Zip-1.0.0ï¼Œå®ƒå°†ä¸ºç¨‹åºå¸¦æ¥å‹ç¼©æ–‡ä»¶å’Œè§£å‹å‹ç¼©åŒ…çš„åŠŸèƒ½ä¸”èƒ½ç‹¬ç«‹ä½¿ç”¨ã€‚

ä¿®å¤ã€ä¿®æ”¹

1. ä¿®å¤äº‹ä»¶å¤šçº¿ç¨‹æ“ä½œæ—¶ï¼Œä¸é€šçŸ¥é—®é¢˜ã€‚
2. ç»„ä»¶çš„æ¡†æ¶ç‰ˆæœ¬ä».NET Framework4.5.2ä¿®æ”¹ä¸º.net standard 2.0ã€‚ï¼ˆæ”¯æŒæ¡†æ¶å‚è€ƒï¼šhttps://docs.microsoft.com/zh-cn/dotnet/standard/net-standardï¼‰

ç§»é™¤

1. ç§»é™¤7zipç¬¬ä¸‰æ–¹ç»„ä»¶çš„ä¾èµ–
2. ç§»é™¤RegistryUtilå·¥å…·ç±»



GeneralUpdate Quick start

```c#
        args = new string[6] {
            "0.0.0.0",
            "1.1.1.1",
            "https://github.com/WELL-E",
             "http://192.168.50.225:7000/update.zip",
             @"E:\PlatformPath",
            "509f0ede227de4a662763a4abe3d8470",
             };

        GeneralUpdateBootstrap bootstrap = new GeneralUpdateBootstrap();
        bootstrap.DownloadStatistics += OnDownloadStatistics;
        bootstrap.ProgressChanged += OnProgressChanged;
        bootstrap.Strategy<DefultStrategy>().
            Option(UpdateOption.Format, "zip").
            Option(UpdateOption.MainApp, "your application name").
            Option(UpdateOption.DownloadTimeOut,60).
            RemoteAddress(args).
            Launch();
```



## ğŸ“2020-08-30

æ–°å¢å†…å®¹

1. åœ¨æ–°çš„å‘å¸ƒä¸­ï¼ŒGeneralUpdate.Core-2.1.0ç‰ˆæœ¬æ–°å¢æ–­ç‚¹ç»­ä¼ åŠŸèƒ½ã€‚
2. åœ¨æ–°çš„å‘å¸ƒä¸­ï¼Œæ–°å¢äº†ç»„ä»¶ GeneralUpdate.Single-1.0.0ï¼Œå®ƒå°†ä¸ºç¨‹åºå¸¦æ¥å•ä¾‹è¿è¡ŒåŠŸèƒ½ï¼Œé˜²æ­¢è‡ªåŠ¨æ›´æ–°ç¨‹åºå¼€å¯å¤šä¸ªã€‚

æ›´æ–°æµç¨‹

1.å®¢æˆ·ç«¯ç¨‹åºå¯åŠ¨ï¼Œå‘æœåŠ¡å™¨è·å–æ›´æ–°ä¿¡æ¯è§£æå¹¶æ¯”å¯¹æ˜¯å¦éœ€è¦æ›´æ–°ã€‚

2.è§£æè¿›ç¨‹ä¼ å‚ã€‚ä¾‹å¦‚ï¼šæœ¬æœºç‰ˆæœ¬å·ã€æœ€æ–°ç‰ˆæœ¬å·ã€ä¸‹è½½åœ°å€ã€è§£å‹è·¯å¾„ã€å®‰è£…è·¯å¾„ç­‰ã€‚

3.å®¢æˆ·ç«¯ç¨‹åºå¯åŠ¨æ›´æ–°ç¨‹åºï¼ˆGeneralUpdateï¼‰ï¼Œå…³é—­è‡ªèº«ï¼ˆå®¢æˆ·ç«¯æŠŠè‡ªå·±å…³æ‰ï¼‰ã€‚

4.è‡ªåŠ¨æ›´æ–°ç¨‹åºï¼ˆGeneralUpdateï¼‰æ ¹æ®ä¼ é€’çš„æ›´æ–°ä¿¡æ¯è¿›è¡Œï¼Œ ï¼ˆ1ï¼‰ä¸‹è½½ã€ï¼ˆ2ï¼‰MD5æ ¡éªŒã€ï¼ˆ3ï¼‰è§£å‹ã€ï¼ˆ4ï¼‰åˆ é™¤æ›´æ–°æ–‡ä»¶ã€ï¼ˆ5ï¼‰æ›¿æ¢æ›´æ–°æ–‡ä»¶ã€ï¼ˆ6ï¼‰å…³é—­æ›´æ–°ç¨‹åºè‡ªèº«ã€ï¼ˆ7ï¼‰å¯åŠ¨å®¢æˆ·ç«¯ã€‚

5.å®Œæˆæ›´æ–°



è¿›ç¨‹ä¹‹é—´ç›¸äº’è°ƒç”¨

```
using System;
using System.Diagnostics;
using System.ComponentModel;

namespace MyProcessSample
{
    class MyProcess
    {
        //æ­¤æ®µä»£ç æ¥è‡ªäºmsdn
        // Opens the Internet Explorer application.
        void OpenApplication(string myFavoritesPath)
        {
            // Start Internet Explorer. Defaults to the home page.
            Process.Start("IExplore.exe");

            // Display the contents of the favorites folder in the browser.
            Process.Start(myFavoritesPath);
        }

        // Opens urls and .html documents using Internet Explorer.
        void OpenWithArguments()
        {
            // url's are not considered documents. They can only be opened
            // by passing them as arguments.
            Process.Start("IExplore.exe", "www.northwindtraders.com");

            // Start a Web page using a browser associated with .html and .asp files.
            Process.Start("IExplore.exe", "C:\\myPath\\myFile.htm");
            Process.Start("IExplore.exe", "C:\\myPath\\myFile.asp");
        }

        // Uses the ProcessStartInfo class to start new processes,
        // both in a minimized mode.
        void OpenWithStartInfo()
        {
            ProcessStartInfo startInfo = new ProcessStartInfo("IExplore.exe");
            startInfo.WindowStyle = ProcessWindowStyle.Minimized;

            Process.Start(startInfo);

            startInfo.Arguments = "www.northwindtraders.com";

            Process.Start(startInfo);
        }

        static void Main()
        {
            // Get the path that stores favorite links.
            string myFavoritesPath =
                Environment.GetFolderPath(Environment.SpecialFolder.Favorites);

            MyProcess myProcess = new MyProcess();

            myProcess.OpenApplication(myFavoritesPath);
            myProcess.OpenWithArguments();
            myProcess.OpenWithStartInfo();
        }
    }
}
```



GeneralUpdate.Core-2.1.0ä½¿ç”¨æ–¹å¼

```c#
 #region Launch1
 args = new string[6] {
            "0.0.0.0",
            "1.1.1.1",
            "https://github.com/WELL-E",
             "http://192.168.50.225:7000/update.zip",
             @"E:\PlatformPath",
            "509f0ede227de4a662763a4abe3d8470",
             };

        GeneralUpdateBootstrap bootstrap = new GeneralUpdateBootstrap();//è‡ªåŠ¨æ›´æ–°å¼•å¯¼ç±»
        bootstrap.DownloadStatistics += OnDownloadStatistics;//ä¸‹è½½è¿›åº¦é€šçŸ¥äº‹ä»¶
        bootstrap.ProgressChanged += OnProgressChanged;//æ›´æ–°è¿›åº¦é€šçŸ¥äº‹ä»¶
        bootstrap.Strategy<DefultStrategy>().//æ³¨å†Œç­–ç•¥ï¼Œå¯è‡ªå®šä¹‰æ›´æ–°æµç¨‹
            Option(UpdateOption.Format, "zip").//æŒ‡å®šæ›´æ–°åŒ…çš„æ ¼å¼ï¼Œç›®å‰åªæ”¯æŒzip
            Option(UpdateOption.MainApp, "your application name").//æŒ‡å®šæ›´æ–°å®Œæˆåéœ€è¦å¯åŠ¨çš„ä¸»ç¨‹åºåç§°ä¸éœ€è¦åŠ .exeç›´æ¥å†™åç§°å³å¯
            Option(UpdateOption.DownloadTimeOut,60).//ä¸‹è½½è¶…æ—¶æ—¶é—´ï¼ˆå•ä½ï¼šç§’ï¼‰,å¦‚æœä¸æŒ‡å®šåˆ™é»˜è®¤è¶…æ—¶æ—¶é—´ä¸º30ç§’ã€‚
            RemoteAddress(args).//è¿™é‡Œçš„å‚æ•°ä¿ç•™äº†ä¹‹å‰çš„å‚æ•°æ•°ç»„é›†åˆ
            Launch();//å¯åŠ¨æ›´æ–°

        #endregion

        #region Launch2

        /*
         * Launch2
         * æ–°å¢äº†ç¬¬äºŒç§å¯åŠ¨æ–¹å¼
         * æµç¨‹ï¼š
         * 1.æŒ‡å®šæ›´æ–°åœ°å€ï¼Œhttps://api.com/GeneralUpdate?version=1.0.0.1 åœ¨webapiä¸­ä¼ å…¥å®¢æˆ·ç«¯å½“å‰ç‰ˆæœ¬å·
         * 2.å¦‚æœéœ€è¦æ›´æ–°apiè¿”å›ç»™ä½ æ‰€æœ‰çš„æ›´æ–°ä¿¡æ¯ï¼ˆè¯¦æƒ…å†…å®¹å‚è€ƒ /Models/UpdateInfo.csï¼‰
         * 3.æ‹¿åˆ°æ›´æ–°ä¿¡æ¯ä¹‹ååˆ™å¼€å§‹httpè¯·æ±‚æ›´æ–°åŒ…
         * 4.ä¸‹è½½
         * 5.è§£å‹
         * 6.æ›´æ–°æœ¬åœ°æ–‡ä»¶
         * 7.å…³é—­æ›´æ–°ç¨‹åº
         * 8.å¯åŠ¨é…ç½®å¥½ä¸»ç¨‹åº
         * æ›´æ–°ç¨‹åºå¿…é¡»è·Ÿä¸»ç¨‹åºæ”¾åœ¨åŒçº§ç›®å½•ä¸‹
         */

        //GeneralUpdateBootstrap bootstrap2 = new GeneralUpdateBootstrap();
        //bootstrap2.DownloadStatistics += OnDownloadStatistics;
        //bootstrap2.ProgressChanged += OnProgressChanged;
        //bootstrap2.Strategy<DefultStrategy>().
        //    Option(UpdateOption.Format, "zip").
        //    Option(UpdateOption.MainApp, "").
		//	  Option(UpdateOption.DownloadTimeOut,60).//ä¸‹è½½è¶…æ—¶æ—¶é—´ï¼ˆå•ä½ï¼šç§’ï¼‰,å¦‚æœä¸æŒ‡å®šåˆ™é»˜è®¤è¶…æ—¶æ—¶é—´ä¸º30ç§’ã€‚
        //    RemoteAddress(@"https://api.com/GeneralUpdate?version=1.0.0.1").//æŒ‡å®šæ›´æ–°åœ°å€
        //    Launch();

    #endregion

    private static void OnProgressChanged(object sender, ProgressChangedEventArgs e)
    {
        if (e.Type == ProgressType.Updatefile)
        {
            var str = $"å½“å‰æ›´æ–°ç¬¬ï¼š{e.ProgressValue}ä¸ª,æ›´æ–°æ–‡ä»¶æ€»æ•°ï¼š{e.TotalSize}";
            Console.WriteLine(str);
        }

        if (e.Type == ProgressType.Done)
        {
            Console.WriteLine("æ›´æ–°å®Œæˆ");
        }
    }

    private static void OnDownloadStatistics(object sender, DownloadStatisticsEventArgs e)
    {
        Console.WriteLine($"ä¸‹è½½é€Ÿåº¦ï¼š{e.Speed}ï¼Œå‰©ä½™æ—¶é—´ï¼š{e.Remaining.Minute}:{e.Remaining.Second}");
    }
```



GeneralUpdate.Single-1.0.0ä½¿ç”¨æ–¹å¼

```
/// <summary>
/// App.xaml çš„äº¤äº’é€»è¾‘
/// </summary>
public partial class App : Application, ISingleInstanceApp
{
    private const string AppId = "{7F280539-0814-4F9C-95BF-D2BB60023657}";

    [STAThread]
    protected override void OnStartup(StartupEventArgs e)
    {
        string[] resultArgs = null;

        if (e.Args == null || e.Args.Length == 0)
        {
            resultArgs = new string[6] {
            "0.0.0.0",
            "1.1.1.1",
            "https://github.com/WELL-E",
             "http://192.168.50.225:7000/update.zip",
             @"E:\PlatformPath",
            "509f0ede227de4a662763a4abe3d8470",
             };
        }
        else
        {
            resultArgs = e.Args;
        }

        if (resultArgs.Length != 6) return;
        if (SingleInstance<App>.InitializeAsFirstInstance(AppId))
        {
            var win = new MainWindow();
            var vm = new MainViewModel(resultArgs, win.Close);
            win.DataContext = vm;

            var application = new App();
            application.InitializeComponent();
            application.Run(win);
            SingleInstance<App>.Cleanup();
        }
    }

    public bool SignalExternalCommandLineArgs(IList<string> args)
    {
        if (this.MainWindow.WindowState == WindowState.Minimized)
        {
            this.MainWindow.WindowState = WindowState.Normal;
        }
        this.MainWindow.Activate();

        return true;
    }
}
```



é—®ç­”Q&A

1.å¦‚æœç‰ˆæœ¬è¿­ä»£å¤šæ¬¡ï¼Œè·¨ç‰ˆæœ¬æ›´æ–°ï¼Œè¯¥æ€ä¹ˆåŠå‘¢ï¼Ÿ

â€‹      åªè¦ä¸æ˜¯æ¡†æ¶çº§åˆ«çš„æ›´æ–°éƒ½æ˜¯å¯ä»¥æ›´æ–°çš„ã€‚ä¸ç®¡ä½ è¿­ä»£å¤šå°‘æ¬¡è·¨äº†å¤šå°‘ä¸ªç‰ˆæœ¬ï¼Œä½ æŠŠæœ€ç»ˆçš„åŒ…æ”¾åˆ°æœåŠ¡å™¨ä¸Šå°±è¡Œäº†ã€‚è¿™ä¸ªé‡Œé¢æ²¡æœ‰æ¶‰åŠåˆ°å¢é‡æ›´æ–°ï¼Œæ‰€ä»¥ä½ æ›´æ–°å¤šäº†ç›´æ¥æŠŠæ‰€æœ‰çš„æ–°æ–‡ä»¶è¦†ç›–ä¸Šå»å°±è¡Œäº†ã€‚

2.GeneralUpdateæ˜¯è·Ÿå®¢æˆ·ç«¯æ˜¯ä¸€ä¸ªæ•´ä½“å—ï¼Ÿ

â€‹      ä¸æ˜¯ï¼ŒGeneralUpdateæ˜¯ä¸€ä¸ªç‹¬ç«‹äºå®¢æˆ·ç«¯çš„ç¨‹åºã€‚

3.èƒ½ä¸èƒ½å¢é‡æ›´æ–°ã€å¤±è´¥è‡ªåŠ¨å›æ»šã€æ›´æ–°æœ¬åœ°æ•°æ®æˆ–é…ç½®æ–‡ä»¶?

â€‹      ç›®å‰ä¸èƒ½ã€‚ï¼ˆè¯¥åŠŸèƒ½å·²åœ¨å¼€å‘è®¡åˆ’å½“ä¸­ï¼‰ã€‚

4.GeneralUpdateæ˜¯å¦‚ä½•æ›´æ–°çš„?

â€‹      æ›´æ–°çš„æ–¹å¼ä¸ºæŠŠæœ¬åœ°åŸæœ‰çš„å®¢æˆ·ç«¯æ–‡ä»¶è¿›è¡Œè¦†ç›–ã€‚





## ğŸ“2020-05-03

1.ç®€æ´å¯åŠ¨ä»£ç  å¦‚ä¸‹ï¼šLaunch1 Launch2

| åç§°                   | ç±»å‹     | å¤‡æ³¨                               |
| ---------------------- | -------- | ---------------------------------- |
| UpdateOption.Format    | é…ç½®å‚æ•° | æ›´æ–°åŒ…çš„å‹ç¼©æ ¼å¼ï¼ˆç›®å‰åªæ”¯æŒzipï¼‰  |
| UpdateOption.MainApp   | é…ç½®å‚æ•° | æ›´æ–°å®Œæˆåéœ€è¦å¯åŠ¨çš„ä¸»ç¨‹åºåç§°     |
| DownloadStatistics     | äº‹ä»¶     | æ›´æ–°åŒ…ä¸‹è½½é€šçŸ¥äº‹ä»¶                 |
| ProgressChanged        | äº‹ä»¶     | æ›´æ–°è¿›åº¦é€šçŸ¥äº‹ä»¶                   |
| Strategy()             | æ–¹æ³•     | ç­–ç•¥æ³¨å…¥                           |
| RemoteAddressï¼ˆï¼‰      | æ–¹æ³•     | è¿œç¨‹åœ°å€é…ç½®ï¼Œå¦‚æœæ²¡æœ‰åˆ™ä¼ å…¥args[] |
| Launch                 | æ–¹æ³•     | å¯åŠ¨æ›´æ–°                           |
| GeneralUpdateBootstrap | ç±»       | æ›´æ–°å¼•å¯¼ç±»                         |

2.æ–°å¢Strategyï¼ˆæ›´æ–°ç­–ç•¥ï¼‰ï¼Œæ›´æ–°ç­–ç•¥æ˜¯å¼€æ”¾å‡ºæ¥è®©å¤§å®¶å¯ä»¥åœ¨ä¸æ”¹åŠ¨æºç çš„æƒ…å†µä¸‹è‡ªç”±æ‰©å±•æ›´æ–°æ–¹å¼å°†ä¸ä¼šä»…é™äºé»˜è®¤çš„æ›´æ–°ç­–ç•¥ã€‚

3.æ›´æ–°æœ¬åœ°æ–‡ä»¶æ—¶ï¼Œä¼šæœ‰æ›´æ–°é€šçŸ¥äº‹ä»¶ã€‚æ˜ç¡®çš„å‘ŠçŸ¥æ›´æ–°æ–‡ä»¶æ€»æ•°å’Œå½“å‰æ›´æ–°åˆ°ç¬¬å‡ ä¸ªæ–‡ä»¶

4.æ–°å¢æ›´æ–°çŠ¶æ€ Checkï¼ˆæ£€æŸ¥æ›´æ–°ï¼‰ï¼ŒDonwloadï¼ˆä¸‹è½½æ›´æ–°åŒ…ï¼‰ï¼ŒUpdatefileï¼ˆæ›´æ–°æ–‡ä»¶ï¼‰ï¼ŒDoneï¼ˆæ›´æ–°å®Œæˆï¼‰ï¼ŒFailï¼ˆæ›´æ–°å¤±è´¥ï¼‰ã€‚å¼€å‘è€…å¯ä»¥ç›´æ¥é€šè¿‡ä¸€ç³»åˆ—æšä¸¾å€¼ç›´æ¥åˆ¤æ–­å½“å‰è¿è¡ŒçŠ¶æ€åšå‡ºç›¸åº”çš„å¤„ç†

5.æ–°å¢è‹¥å¹²å¯åŠ¨é…ç½®å‚æ•°çš„éªŒè¯

```c#
if (args != null)
{
    if (args.Length == 0)
    {
        throw new NullReferenceException("Args does not contain any elements.");
    }

    if (args.Length > elementNum)
    {
        throw new Exception($"The number of args cannot be greater than { elementNum }");
    }
}

if (string.IsNullOrWhiteSpace(PacketName))
{
    throw new NullReferenceException("packet name not set");
}

if (string.IsNullOrWhiteSpace(DownloadPath))
{
    throw new NullReferenceException("download path not set");
}

if (string.IsNullOrWhiteSpace(InstallPath))
{
    throw new NullReferenceException("install path not set");
}

if (string.IsNullOrWhiteSpace(MD5))
{
    throw new NullReferenceException("install path not set");
}
```

6.ä¸‹è½½æ›´æ–°è¿›åº¦é€šçŸ¥äº‹ä»¶ï¼Œå°†ä¼šæä¾›å‰©ä½™ä¸‹è½½æ—¶é—´ï¼ˆRemainingï¼‰å’Œä¸‹è½½é€Ÿåº¦ï¼ˆSpeedï¼‰

```c#
           #region Launch1

            args = new string[6] {
                "0.0.0.0",
                "1.1.1.1",
                "https://github.com/WELL-E",
                 "http://192.168.50.225:7000/update.zip",
                 @"E:\PlatformPath",
                "509f0ede227de4a662763a4abe3d8470",
                 };

            GeneralUpdateBootstrap bootstrap = new GeneralUpdateBootstrap();
            bootstrap.DownloadStatistics += OnDownloadStatistics;
            bootstrap.ProgressChanged += OnProgressChanged;
            bootstrap.Strategy<DefultStrategy>().
                Option(UpdateOption.Format, "zip").//æŒ‡å®šæ›´æ–°åŒ…çš„æ ¼å¼ï¼Œç›®å‰åªæ”¯æŒzip
                Option(UpdateOption.MainApp, "your application name").//æŒ‡å®šæ›´æ–°å®Œæˆåéœ€è¦å¯åŠ¨çš„ä¸»ç¨‹åºåç§°ä¸éœ€è¦åŠ .exeç›´æ¥å†™åç§°å³å¯
                RemoteAddress(args).//è¿™é‡Œçš„å‚æ•°ä¿ç•™äº†ä¹‹å‰çš„å‚æ•°æ•°ç»„é›†åˆ
                Launch();

            #endregion

            #region Launch2

            /*
             * Launch2
             * æ–°å¢äº†ç¬¬äºŒç§å¯åŠ¨æ–¹å¼
             * æµç¨‹ï¼š
             * 1.æŒ‡å®šæ›´æ–°åœ°å€ï¼Œhttps://api.com/GeneralUpdate?version=1.0.0.1 åœ¨webapiä¸­ä¼ å…¥å®¢æˆ·ç«¯å½“å‰ç‰ˆæœ¬å·
             * 2.å¦‚æœéœ€è¦æ›´æ–°apiè¿”å›ç»™ä½ æ‰€æœ‰çš„æ›´æ–°ä¿¡æ¯ï¼ˆè¯¦æƒ…å†…å®¹å‚è€ƒ /Models/UpdateInfo.csï¼‰
             * 3.æ‹¿åˆ°æ›´æ–°ä¿¡æ¯ä¹‹ååˆ™å¼€å§‹httpè¯·æ±‚æ›´æ–°åŒ…
             * 4.ä¸‹è½½
             * 5.è§£å‹
             * 6.æ›´æ–°æœ¬åœ°æ–‡ä»¶
             * 7.å…³é—­æ›´æ–°ç¨‹åº
             * 8.å¯åŠ¨é…ç½®å¥½ä¸»ç¨‹åº
             * æ›´æ–°ç¨‹åºå¿…é¡»è·Ÿä¸»ç¨‹åºæ”¾åœ¨åŒçº§ç›®å½•ä¸‹
             */

            //GeneralUpdateBootstrap bootstrap2 = new GeneralUpdateBootstrap();
            //bootstrap2.DownloadStatistics += OnDownloadStatistics;
            //bootstrap2.ProgressChanged += OnProgressChanged;
            //bootstrap2.Strategy<DefultStrategy>().
            //    Option(UpdateOption.Format, "zip").
            //    Option(UpdateOption.MainApp, "KGS.CPP").
            //    RemoteAddress(@"https://api.com/GeneralUpdate?version=1.0.0.1").//æŒ‡å®šæ›´æ–°åœ°å€
            //    Launch();

            #endregion


  private static void OnProgressChanged(object sender, ProgressChangedEventArgs e)
        {
            if (e.Type == ProgressType.Updatefile)
            {
                var str = $"å½“å‰æ›´æ–°ç¬¬ï¼š{e.ProgressValue}ä¸ª,æ›´æ–°æ–‡ä»¶æ€»æ•°ï¼š{e.TotalSize}";
                Console.WriteLine(str);
            }

            if (e.Type == ProgressType.Done)
            {
                Console.WriteLine("æ›´æ–°å®Œæˆ");
            }
        }

        private static void OnDownloadStatistics(object sender, DownloadStatisticsEventArgs e)
        {
            Console.WriteLine($"ä¸‹è½½é€Ÿåº¦ï¼š{e.Speed}ï¼Œå‰©ä½™æ—¶é—´ï¼š{e.Remaining.Minute}:{e.Remaining.Second}");
        }
```
